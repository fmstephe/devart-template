DocumentsPackagesTheProjectHelpBlogPlayTheGoProgrammingLanguageTheGoProgrammingLanguageSpecificationVersionofNov13,2013IntroductionNotationSourcecoderepresentationCharactersLettersanddigitsLexicalelementsCommentsTokensSemicolonsIdentifiersKeywordsOperatorsandDelimitersIntegerliteralsFloating-pointliteralsImaginaryliteralsRuneliteralsStringliteralsConstantsTypesMethodsetsBooleantypesNumerictypesStringtypesArraytypesSlicetypesStructtypesPointertypesFunctiontypesInterfacetypesMaptypesChanneltypesPropertiesoftypesandvaluesTypeidentityAssignabilityBlocksDeclarationsandscopeLabelscopesBlankidentifierPredeclaredidentifiersExportedidentifiersUniquenessofidentifiersConstantdeclarationsIotaTypedeclarationsVariabledeclarationsShortvariabledeclarationsFunctiondeclarationsMethoddeclarationsExpressionsOperandsQualifiedidentifiersCompositeliteralsFunctionliteralsPrimaryexpressionsSelectorsIndexexpressionsSliceexpressionsTypeassertionsCallsPassingargumentsto...parametersOperatorsOperatorprecedenceArithmeticoperatorsIntegeroverflowComparisonoperatorsLogicaloperatorsAddressoperatorsReceiveoperatorMethodexpressionsMethodvaluesConversionsConstantexpressionsOrderofevaluationStatementsTerminatingstatementsEmptystatementsLabeledstatementsExpressionstatementsSendstatementsIncDecstatementsAssignmentsIfstatementsSwitchstatementsForstatementsGostatementsSelectstatementsReturnstatementsBreakstatementsContinuestatementsGotostatementsFallthroughstatementsDeferstatementsBuilt-infunctionsCloseLengthandcapacityAllocationMakingslices,mapsandchannelsAppendingtoandcopyingslicesDeletionofmapelementsManipulatingcomplexnumbersHandlingpanicsBootstrappingPackagesSourcefileorganizationPackageclauseImportdeclarationsAnexamplepackagePrograminitializationandexecutionThezerovalueProgramexecutionErrorsRun-timepanicsSystemconsiderationsPackageunsafeSizeandalignmentguaranteesIntroductionThisisareferencemanualfortheGoprogramminglanguage.Formoreinformationandotherdocuments,seehttp://golang.org.Goisageneral-purposelanguagedesignedwithsystemsprogramminginmind.Itisstronglytypedandgarbage-collectedandhasexplicitsupportforconcurrentprogramming.Programsareconstructedfrompackages,whosepropertiesallowefficientmanagementofdependencies.Theexistingimplementationsuseatraditionalcompile/linkmodeltogenerateexecutablebinaries.Thegrammariscompactandregular,allowingforeasyanalysisbyautomatictoolssuchasintegrateddevelopmentenvironments.NotationThesyntaxisspecifiedusingExtendedBackus-NaurForm(EBNF):Production=production_name"="[Expression]".".Expression=Alternative{"|"Alternative}.Alternative=Term{Term}.Term=production_name|token["…"token]|Group|Option|Repetition.Group="("Expression")".Option="["Expression"]".Repetition="{"Expression"}".Productionsareexpressionsconstructedfromtermsandthefollowingoperators,inincreasingprecedence:|alternation()grouping[]option(0or1times){}repetition(0tontimes)Lower-caseproductionnamesareusedtoidentifylexicaltokens.Non-terminalsareinCamelCase.Lexicaltokensareenclosedindoublequotes""orbackquotes``.Theforma…brepresentsthesetofcharactersfromathroughbasalternatives.Thehorizontalellipsis…isalsousedelsewhereinthespectoinformallydenotevariousenumerationsorcodesnippetsthatarenotfurtherspecified.Thecharacter…(asopposedtothethreecharacters...)isnotatokenoftheGolanguage.SourcecoderepresentationSourcecodeisUnicodetextencodedinUTF-8.Thetextisnotcanonicalized,soasingleaccentedcodepointisdistinctfromthesamecharacterconstructedfromcombininganaccentandaletter;thosearetreatedastwocodepoints.Forsimplicity,thisdocumentwillusetheunqualifiedtermcharactertorefertoaUnicodecodepointinthesourcetext.Eachcodepointisdistinct;forinstance,upperandlowercaselettersaredifferentcharacters.Implementationrestriction:Forcompatibilitywithothertools,acompilermaydisallowtheNULcharacter(U+0000)inthesourcetext.Implementationrestriction:Forcompatibilitywithothertools,acompilermayignoreaUTF-8-encodedbyteordermark(U+FEFF)ifitisthefirstUnicodecodepointinthesourcetext.Abyteordermarkmaybedisallowedanywhereelseinthesource.CharactersThefollowingtermsareusedtodenotespecificUnicodecharacterclasses:newline=/*theUnicodecodepointU+000A*/.unicode_char=/*anarbitraryUnicodecodepointexceptnewline*/.unicode_letter=/*aUnicodecodepointclassifiedas"Letter"*/.unicode_digit=/*aUnicodecodepointclassifiedas"DecimalDigit"*/.InTheUnicodeStandard6.2,Section4.5"GeneralCategory"definesasetofcharactercategories.GotreatsthosecharactersincategoryLu,Ll,Lt,Lm,orLoasUnicodeletters,andthoseincategoryNdasUnicodedigits.LettersanddigitsTheunderscorecharacter_(U+005F)isconsideredaletter.letter=unicode_letter|"_".decimal_digit="0"…"9".octal_digit="0"…"7".hex_digit="0"…"9"|"A"…"F"|"a"…"f".LexicalelementsCommentsTherearetwoformsofcomments:Linecommentsstartwiththecharactersequence//andstopattheendoftheline.Alinecommentactslikeanewline.Generalcommentsstartwiththecharactersequence/*andcontinuethroughthecharactersequence*/.Ageneralcommentcontainingoneormorenewlinesactslikeanewline,otherwiseitactslikeaspace.Commentsdonotnest.TokensTokensformthevocabularyoftheGolanguage.Therearefourclasses:identifiers,keywords,operatorsanddelimiters,andliterals.Whitespace,formedfromspaces(U+0020),horizontaltabs(U+0009),carriagereturns(U+000D),andnewlines(U+000A),isignoredexceptasitseparatestokensthatwouldotherwisecombineintoasingletoken.Also,anewlineorendoffilemaytriggertheinsertionofasemicolon.Whilebreakingtheinputintotokens,thenexttokenisthelongestsequenceofcharactersthatformavalidtoken.SemicolonsTheformalgrammarusessemicolons";"asterminatorsinanumberofproductions.Goprogramsmayomitmostofthesesemicolonsusingthefollowingtworules:Whentheinputisbrokenintotokens,asemicolonisautomaticallyinsertedintothetokenstreamattheendofanon-blanklineiftheline'sfinaltokenisanidentifieraninteger,floating-point,imaginary,rune,orstringliteraloneofthekeywordsbreak,continue,fallthrough,orreturnoneoftheoperatorsanddelimiters++,--,),],or}Toallowcomplexstatementstooccupyasingleline,asemicolonmaybeomittedbeforeaclosing")"or"}".Toreflectidiomaticuse,codeexamplesinthisdocumentelidesemicolonsusingtheserules.IdentifiersIdentifiersnameprogramentitiessuchasvariablesandtypes.Anidentifierisasequenceofoneormorelettersanddigits.Thefirstcharacterinanidentifiermustbealetter.identifier=letter{letter|unicode_digit}.a_x9ThisVariableIsExportedαβSomeidentifiersarepredeclared.KeywordsThefollowingkeywordsarereservedandmaynotbeusedasidentifiers.breakdefaultfuncinterfaceselectcasedefergomapstructchanelsegotopackageswitchconstfallthroughifrangetypecontinueforimportreturnvarOperatorsandDelimitersThefollowingcharactersequencesrepresentoperators,delimiters,andotherspecialtokens:+&+=&=&&==!=()-|-=|=||<<=[]*^*=^=<->>={}/<</=<<=++=:=,;%>>%=>>=--!....:&^&^=IntegerliteralsAnintegerliteralisasequenceofdigitsrepresentinganintegerconstant.Anoptionalprefixsetsanon-decimalbase:0foroctal,0xor0Xforhexadecimal.Inhexadecimalliterals,lettersa-fandA-Frepresentvalues10through15.int_lit=decimal_lit|octal_lit|hex_lit.decimal_lit=("1"…"9"){decimal_digit}.octal_lit="0"{octal_digit}.hex_lit="0"("x"|"X")hex_digit{hex_digit}.4206000xBadFace170141183460469231731687303715884105727Floating-pointliteralsAfloating-pointliteralisadecimalrepresentationofafloating-pointconstant.Ithasanintegerpart,adecimalpoint,afractionalpart,andanexponentpart.Theintegerandfractionalpartcomprisedecimaldigits;theexponentpartisaneorEfollowedbyanoptionallysigneddecimalexponent.Oneoftheintegerpartorthefractionalpartmaybeelided;oneofthedecimalpointortheexponentmaybeelided.float_lit=decimals"."[decimals][exponent]|decimalsexponent|"."decimals[exponent].decimals=decimal_digit{decimal_digit}.exponent=("e"|"E")["+"|"-"]decimals.0.72.40072.40//==72.402.718281.e+06.67428e-111E6.25.12345E+5ImaginaryliteralsAnimaginaryliteralisadecimalrepresentationoftheimaginarypartofacomplexconstant.Itconsistsofafloating-pointliteralordecimalintegerfollowedbythelower-caseletteri.imaginary_lit=(decimals|float_lit)"i".0i011i//==11i0.i2.71828i1.e+0i6.67428e-11i1E6i.25i.12345E+5iRuneliteralsAruneliteralrepresentsaruneconstant,anintegervalueidentifyingaUnicodecodepoint.Aruneliteralisexpressedasoneormorecharactersenclosedinsinglequotes.Withinthequotes,anycharactermayappearexceptsinglequoteandnewline.AsinglequotedcharacterrepresentstheUnicodevalueofthecharacteritself,whilemulti-charactersequencesbeginningwithabackslashencodevaluesinvariousformats.Thesimplestformrepresentsthesinglecharacterwithinthequotes;sinceGosourcetextisUnicodecharactersencodedinUTF-8,multipleUTF-8-encodedbytesmayrepresentasingleintegervalue.Forinstance,theliteral'a'holdsasinglebyterepresentingaliterala,UnicodeU+0061,value0x61,while'ä'holdstwobytes(0xc30xa4)representingaliterala-dieresis,U+00E4,value0xe4.SeveralbackslashescapesallowarbitraryvaluestobeencodedasASCIItext.Therearefourwaystorepresenttheintegervalueasanumericconstant:\xfollowedbyexactlytwohexadecimaldigits;\ufollowedbyexactlyfourhexadecimaldigits;\Ufollowedbyexactlyeighthexadecimaldigits,andaplainbackslash\followedbyexactlythreeoctaldigits.Ineachcasethevalueoftheliteralisthevaluerepresentedbythedigitsinthecorrespondingbase.Althoughtheserepresentationsallresultinaninteger,theyhavedifferentvalidranges.Octalescapesmustrepresentavaluebetween0and255inclusive.Hexadecimalescapessatisfythisconditionbyconstruction.Theescapes\uand\UrepresentUnicodecodepointssowithinthemsomevaluesareillegal,inparticularthoseabove0x10FFFFandsurrogatehalves.Afterabackslash,certainsingle-characterescapesrepresentspecialvalues:\aU+0007alertorbell\bU+0008backspace\fU+000Cformfeed\nU+000Alinefeedornewline\rU+000Dcarriagereturn\tU+0009horizontaltab\vU+000bverticaltab\\U+005cbackslash\'U+0027singlequote(validescapeonlywithinruneliterals)\"U+0022doublequote(validescapeonlywithinstringliterals)Allothersequencesstartingwithabackslashareillegalinsideruneliterals.rune_lit="'"(unicode_value|byte_value)"'".unicode_value=unicode_char|little_u_value|big_u_value|escaped_char.byte_value=octal_byte_value|hex_byte_value.octal_byte_value=`\`octal_digitoctal_digitoctal_digit.hex_byte_value=`\`"x"hex_digithex_digit.little_u_value=`\`"u"hex_digithex_digithex_digithex_digit.big_u_value=`\`"U"hex_digithex_digithex_digithex_digithex_digithex_digithex_digithex_digit.escaped_char=`\`("a"|"b"|"f"|"n"|"r"|"t"|"v"|`\`|"'"|`"`).'a''ä''本''\t''\000''\007''\377''\x07''\xff''\u12e4''\U00101234''aa'//illegal:toomanycharacters'\xa'//illegal:toofewhexadecimaldigits'\0'//illegal:toofewoctaldigits'\uDFFF'//illegal:surrogatehalf'\U00110000'//illegal:invalidUnicodecodepointStringliteralsAstringliteralrepresentsastringconstantobtainedfromconcatenatingasequenceofcharacters.Therearetwoforms:rawstringliteralsandinterpretedstringliterals.Rawstringliteralsarecharactersequencesbetweenbackquotes``.Withinthequotes,anycharacterislegalexceptbackquote.Thevalueofarawstringliteralisthestringcomposedoftheuninterpreted(implicitlyUTF-8-encoded)charactersbetweenthequotes;inparticular,backslasheshavenospecialmeaningandthestringmaycontainnewlines.Carriagereturnsinsiderawstringliteralsarediscardedfromtherawstringvalue.Interpretedstringliteralsarecharactersequencesbetweendoublequotes"".Thetextbetweenthequotes,whichmaynotcontainnewlines,formsthevalueoftheliteral,withbackslashescapesinterpretedastheyareinruneliterals(exceptthat\'isillegaland\"islegal),withthesamerestrictions.Thethree-digitoctal(\nnn)andtwo-digithexadecimal(\xnn)escapesrepresentindividualbytesoftheresultingstring;allotherescapesrepresentthe(possiblymulti-byte)UTF-8encodingofindividualcharacters.Thusinsideastringliteral\377and\xFFrepresentasinglebyteofvalue0xFF=255,whileÿ,\u00FF,\U000000FFand\xc3\xbfrepresentthetwobytes0xc30xbfoftheUTF-8encodingofcharacterU+00FF.string_lit=raw_string_lit|interpreted_string_lit.raw_string_lit="`"{unicode_char|newline}"`".interpreted_string_lit=`"`{unicode_value|byte_value}`"`.`abc`//sameas"abc"`\n\n`//sameas"\\n\n\\n""\n""""Hello,world!\n""日本語""\u65e5本\U00008a9e""\xff\u00FF""\uD800"//illegal:surrogatehalf"\U00110000"//illegal:invalidUnicodecodepointTheseexamplesallrepresentthesamestring:"日本語"//UTF-8inputtext`日本語`//UTF-8inputtextasarawliteral"\u65e5\u672c\u8a9e"//theexplicitUnicodecodepoints"\U000065e5\U0000672c\U00008a9e"//theexplicitUnicodecodepoints"\xe6\x97\xa5\xe6\x9c\xac\xe8\xaa\x9e"//theexplicitUTF-8bytesIfthesourcecoderepresentsacharacterastwocodepoints,suchasacombiningforminvolvinganaccentandaletter,theresultwillbeanerrorifplacedinaruneliteral(itisnotasinglecodepoint),andwillappearastwocodepointsifplacedinastringliteral.ConstantsTherearebooleanconstants,runeconstants,integerconstants,floating-pointconstants,complexconstants,andstringconstants.Rune,integer,floating-point,andcomplexconstantsarecollectivelycallednumericconstants.Aconstantvalueisrepresentedbyarune,integer,floating-point,imaginary,orstringliteral,anidentifierdenotingaconstant,aconstantexpression,aconversionwitharesultthatisaconstant,ortheresultvalueofsomebuilt-infunctionssuchasunsafe.Sizeofappliedtoanyvalue,caporlenappliedtosomeexpressions,realandimagappliedtoacomplexconstantandcomplexappliedtonumericconstants.Thebooleantruthvaluesarerepresentedbythepredeclaredconstantstrueandfalse.Thepredeclaredidentifieriotadenotesanintegerconstant.Ingeneral,complexconstantsareaformofconstantexpressionandarediscussedinthatsection.Numericconstantsrepresentvaluesofarbitraryprecisionanddonotoverflow.Constantsmaybetypedoruntyped.Literalconstants,true,false,iota,andcertainconstantexpressionscontainingonlyuntypedconstantoperandsareuntyped.Aconstantmaybegivenatypeexplicitlybyaconstantdeclarationorconversion,orimplicitlywhenusedinavariabledeclarationoranassignmentorasanoperandinanexpression.Itisanerroriftheconstantvaluecannotberepresentedasavalueoftherespectivetype.Forinstance,3.0canbegivenanyintegeroranyfloating-pointtype,while2147483648.0(equalto1<<31)canbegiventhetypesfloat32,float64,oruint32butnotint32orstring.TherearenoconstantsdenotingtheIEEE-754infinityandnot-a-numbervalues,butthemathpackage'sInf,NaN,IsInf,andIsNaNfunctionsreturnandtestforthosevaluesatruntime.Implementationrestriction:Althoughnumericconstantshavearbitraryprecisioninthelanguage,acompilermayimplementthemusinganinternalrepresentationwithlimitedprecision.Thatsaid,everyimplementationmust:Representintegerconstantswithatleast256bits.Representfloating-pointconstants,includingthepartsofacomplexconstant,withamantissaofatleast256bitsandasignedexponentofatleast32bits.Giveanerrorifunabletorepresentanintegerconstantprecisely.Giveanerrorifunabletorepresentafloating-pointorcomplexconstantduetooverflow.Roundtothenearestrepresentableconstantifunabletorepresentafloating-pointorcomplexconstantduetolimitsonprecision.Theserequirementsapplybothtoliteralconstantsandtotheresultofevaluatingconstantexpressions.TypesAtypedeterminesthesetofvaluesandoperationsspecifictovaluesofthattype.Typesmaybenamedorunnamed.Namedtypesarespecifiedbya(possiblyqualified)typename;unnamedtypesarespecifiedusingatypeliteral,whichcomposesanewtypefromexistingtypes.Type=TypeName|TypeLit|"("Type")".TypeName=identifier|QualifiedIdent.TypeLit=ArrayType|StructType|PointerType|FunctionType|InterfaceType|SliceType|MapType|ChannelType.Namedinstancesoftheboolean,numeric,andstringtypesarepredeclared.Compositetypes—array,struct,pointer,function,interface,slice,map,andchanneltypes—maybeconstructedusingtypeliterals.Thestatictype(orjusttype)ofavariableisthetypedefinedbyitsdeclaration.Variablesofinterfacetypealsohaveadistinctdynamictype,whichistheactualtypeofthevaluestoredinthevariableatruntime.Thedynamictypemayvaryduringexecutionbutisalwaysassignabletothestatictypeoftheinterfacevariable.Fornon-interfacetypes,thedynamictypeisalwaysthestatictype.EachtypeThasanunderlyingtype:IfTisapredeclaredtypeoratypeliteral,thecorrespondingunderlyingtypeisTitself.Otherwise,T'sunderlyingtypeistheunderlyingtypeofthetypetowhichTrefersinitstypedeclaration.typeT1stringtypeT2T1typeT3[]T1typeT4T3Theunderlyingtypeofstring,T1,andT2isstring.Theunderlyingtypeof[]T1,T3,andT4is[]T1.MethodsetsAtypemayhaveamethodsetassociatedwithit(§Interfacetypes,§Methoddeclarations).Themethodsetofaninterfacetypeisitsinterface.ThemethodsetofanyothertypeTconsistsofallmethodswithreceivertypeT.Themethodsetofthecorrespondingpointertype*Tisthesetofallmethodswithreceiver*TorT(thatis,italsocontainsthemethodsetofT).Furtherrulesapplytostructscontaininganonymousfields,asdescribedinthesectiononstructtypes.Anyothertypehasanemptymethodset.Inamethodset,eachmethodmusthaveauniquemethodname.Themethodsetofatypedeterminestheinterfacesthatthetypeimplementsandthemethodsthatcanbecalledusingareceiverofthattype.BooleantypesAbooleantyperepresentsthesetofBooleantruthvaluesdenotedbythepredeclaredconstantstrueandfalse.Thepredeclaredbooleantypeisbool.NumerictypesAnumerictyperepresentssetsofintegerorfloating-pointvalues.Thepredeclaredarchitecture-independentnumerictypesare:uint8thesetofallunsigned8-bitintegers(0to255)uint16thesetofallunsigned16-bitintegers(0to65535)uint32thesetofallunsigned32-bitintegers(0to4294967295)uint64thesetofallunsigned64-bitintegers(0to18446744073709551615)int8thesetofallsigned8-bitintegers(-128to127)int16thesetofallsigned16-bitintegers(-32768to32767)int32thesetofallsigned32-bitintegers(-2147483648to2147483647)int64thesetofallsigned64-bitintegers(-9223372036854775808to9223372036854775807)float32thesetofallIEEE-75432-bitfloating-pointnumbersfloat64thesetofallIEEE-75464-bitfloating-pointnumberscomplex64thesetofallcomplexnumberswithfloat32realandimaginarypartscomplex128thesetofallcomplexnumberswithfloat64realandimaginarypartsbytealiasforuint8runealiasforint32Thevalueofann-bitintegerisnbitswideandrepresentedusingtwo'scomplementarithmetic.Thereisalsoasetofpredeclarednumerictypeswithimplementation-specificsizes:uinteither32or64bitsintsamesizeasuintuintptranunsignedintegerlargeenoughtostoretheuninterpretedbitsofapointervalueToavoidportabilityissuesallnumerictypesaredistinctexceptbyte,whichisanaliasforuint8,andrune,whichisanaliasforint32.Conversionsarerequiredwhendifferentnumerictypesaremixedinanexpressionorassignment.Forinstance,int32andintarenotthesametypeeventhoughtheymayhavethesamesizeonaparticulararchitecture.StringtypesAstringtyperepresentsthesetofstringvalues.Astringvalueisa(possiblyempty)sequenceofbytes.Stringsareimmutable:oncecreated,itisimpossibletochangethecontentsofastring.Thepredeclaredstringtypeisstring.Thelengthofastrings(itssizeinbytes)canbediscoveredusingthebuilt-infunctionlen.Thelengthisacompile-timeconstantifthestringisaconstant.Astring'sbytescanbeaccessedbyintegerindices0throughlen(s)-1.Itisillegaltotaketheaddressofsuchanelement;ifs[i]isthei'thbyteofastring,&s[i]isinvalid.ArraytypesAnarrayisanumberedsequenceofelementsofasingletype,calledtheelementtype.Thenumberofelementsiscalledthelengthandisnevernegative.ArrayType="["ArrayLength"]"ElementType.ArrayLength=Expression.ElementType=Type.Thelengthispartofthearray'stype;itmustevaluatetoanon-negativeconstantrepresentablebyavalueoftypeint.Thelengthofarrayacanbediscoveredusingthebuilt-infunctionlen.Theelementscanbeaddressedbyintegerindices0throughlen(a)-1.Arraytypesarealwaysone-dimensionalbutmaybecomposedtoformmulti-dimensionaltypes.[32]byte[2*N]struct{x,yint32}[1000]*float64[3][5]int[2][2][2]float64//sameas[2]([2]([2]float64))SlicetypesAsliceisadescriptorforacontiguoussegmentofanunderlyingarrayandprovidesaccesstoanumberedsequenceofelementsfromthatarray.Aslicetypedenotesthesetofallslicesofarraysofitselementtype.Thevalueofanuninitializedsliceisnil.SliceType="[""]"ElementType.Likearrays,slicesareindexableandhavealength.Thelengthofaslicescanbediscoveredbythebuilt-infunctionlen;unlikewitharraysitmaychangeduringexecution.Theelementscanbeaddressedbyintegerindices0throughlen(s)-1.Thesliceindexofagivenelementmaybelessthantheindexofthesameelementintheunderlyingarray.Aslice,onceinitialized,isalwaysassociatedwithanunderlyingarraythatholdsitselements.Aslicethereforesharesstoragewithitsarrayandwithotherslicesofthesamearray;bycontrast,distinctarraysalwaysrepresentdistinctstorage.Thearrayunderlyingaslicemayextendpasttheendoftheslice.Thecapacityisameasureofthatextent:itisthesumofthelengthofthesliceandthelengthofthearraybeyondtheslice;asliceoflengthuptothatcapacitycanbecreatedbyslicinganewonefromtheoriginalslice.Thecapacityofasliceacanbediscoveredusingthebuilt-infunctioncap(a).Anew,initializedslicevalueforagivenelementtypeTismadeusingthebuilt-infunctionmake,whichtakesaslicetypeandparametersspecifyingthelengthandoptionallythecapacity.Aslicecreatedwithmakealwaysallocatesanew,hiddenarraytowhichthereturnedslicevaluerefers.Thatis,executingmake([]T,length,capacity)producesthesamesliceasallocatinganarrayandslicingit,sothesetwoexpressionsareequivalent:make([]int,50,100)new([100]int)[0:50]Likearrays,slicesarealwaysone-dimensionalbutmaybecomposedtoconstructhigher-dimensionalobjects.Witharraysofarrays,theinnerarraysare,byconstruction,alwaysthesamelength;howeverwithslicesofslices(orarraysofslices),theinnerlengthsmayvarydynamically.Moreover,theinnerslicesmustbeinitializedindividually.StructtypesAstructisasequenceofnamedelements,calledfields,eachofwhichhasanameandatype.Fieldnamesmaybespecifiedexplicitly(IdentifierList)orimplicitly(AnonymousField).Withinastruct,non-blankfieldnamesmustbeunique.StructType="struct""{"{FieldDecl";"}"}".FieldDecl=(IdentifierListType|AnonymousField)[Tag].AnonymousField=["*"]TypeName.Tag=string_lit.//Anemptystruct.struct{}//Astructwith6fields.struct{x,yintufloat32_float32//paddingA*[]intFfunc()}Afielddeclaredwithatypebutnoexplicitfieldnameisananonymousfield,alsocalledanembeddedfieldoranembeddingofthetypeinthestruct.AnembeddedtypemustbespecifiedasatypenameTorasapointertoanon-interfacetypename*T,andTitselfmaynotbeapointertype.Theunqualifiedtypenameactsasthefieldname.//AstructwithfouranonymousfieldsoftypeT1,*T2,P.T3and*P.T4struct{T1//fieldnameisT1*T2//fieldnameisT2P.T3//fieldnameisT3*P.T4//fieldnameisT4x,yint//fieldnamesarexandy}Thefollowingdeclarationisillegalbecausefieldnamesmustbeuniqueinastructtype:struct{T//conflictswithanonymousfield*Tand*P.T*T//conflictswithanonymousfieldTand*P.T*P.T//conflictswithanonymousfieldTand*T}Afieldormethodfofananonymousfieldinastructxiscalledpromotedifx.fisalegalselectorthatdenotesthatfieldormethodf.Promotedfieldsactlikeordinaryfieldsofastructexceptthattheycannotbeusedasfieldnamesincompositeliteralsofthestruct.GivenastructtypeSandatypenamedT,promotedmethodsareincludedinthemethodsetofthestructasfollows:IfScontainsananonymousfieldT,themethodsetsofSand*SbothincludepromotedmethodswithreceiverT.Themethodsetof*Salsoincludespromotedmethodswithreceiver*T.IfScontainsananonymousfield*T,themethodsetsofSand*SbothincludepromotedmethodswithreceiverTor*T.Afielddeclarationmaybefollowedbyanoptionalstringliteraltag,whichbecomesanattributeforallthefieldsinthecorrespondingfielddeclaration.Thetagsaremadevisiblethroughareflectioninterfaceandtakepartintypeidentityforstructsbutareotherwiseignored.//AstructcorrespondingtotheTimeStampprotocolbuffer.//Thetagstringsdefinetheprotocolbufferfieldnumbers.struct{microsecuint64"field1"serverIP6uint64"field2"processstring"field3"}PointertypesApointertypedenotesthesetofallpointerstovariablesofagiventype,calledthebasetypeofthepointer.Thevalueofanuninitializedpointerisnil.PointerType="*"BaseType.BaseType=Type.*Point*[4]intFunctiontypesAfunctiontypedenotesthesetofallfunctionswiththesameparameterandresulttypes.Thevalueofanuninitializedvariableoffunctiontypeisnil.FunctionType="func"Signature.Signature=Parameters[Result].Result=Parameters|Type.Parameters="("[ParameterList[","]]")".ParameterList=ParameterDecl{","ParameterDecl}.ParameterDecl=[IdentifierList]["..."]Type.Withinalistofparametersorresults,thenames(IdentifierList)musteitherallbepresentorallbeabsent.Ifpresent,eachnamestandsforoneitem(parameterorresult)ofthespecifiedtypeandallnon-blanknamesinthesignaturemustbeunique.Ifabsent,eachtypestandsforoneitemofthattype.Parameterandresultlistsarealwaysparenthesizedexceptthatifthereisexactlyoneunnamedresultitmaybewrittenasanunparenthesizedtype.Thefinalparameterinafunctionsignaturemayhaveatypeprefixedwith....Afunctionwithsuchaparameteriscalledvariadicandmaybeinvokedwithzeroormoreargumentsforthatparameter.func()func(xint)intfunc(a,_int,zfloat32)boolfunc(a,bint,zfloat32)(bool)func(prefixstring,values...int)func(a,bint,zfloat64,opt...interface{})(successbool)func(int,int,float64)(float64,*[]int)func(nint)func(p*T)InterfacetypesAninterfacetypespecifiesamethodsetcalleditsinterface.Avariableofinterfacetypecanstoreavalueofanytypewithamethodsetthatisanysupersetoftheinterface.Suchatypeissaidtoimplementtheinterface.Thevalueofanuninitializedvariableofinterfacetypeisnil.InterfaceType="interface""{"{MethodSpec";"}"}".MethodSpec=MethodNameSignature|InterfaceTypeName.MethodName=identifier.InterfaceTypeName=TypeName.Aswithallmethodsets,inaninterfacetype,eachmethodmusthaveauniquename.//AsimpleFileinterfaceinterface{Read(bBuffer)boolWrite(bBuffer)boolClose()}Morethanonetypemayimplementaninterface.Forinstance,iftwotypesS1andS2havethemethodsetfunc(pT)Read(bBuffer)bool{return…}func(pT)Write(bBuffer)bool{return…}func(pT)Close(){…}(whereTstandsforeitherS1orS2)thentheFileinterfaceisimplementedbybothS1andS2,regardlessofwhatothermethodsS1andS2mayhaveorshare.Atypeimplementsanyinterfacecomprisinganysubsetofitsmethodsandmaythereforeimplementseveraldistinctinterfaces.Forinstance,alltypesimplementtheemptyinterface:interface{}Similarly,considerthisinterfacespecification,whichappearswithinatypedeclarationtodefineaninterfacecalledLock:typeLockinterface{Lock()Unlock()}IfS1andS2alsoimplementfunc(pT)Lock(){…}func(pT)Unlock(){…}theyimplementtheLockinterfaceaswellastheFileinterface.AninterfacemayuseaninterfacetypenameTinplaceofamethodspecification.Theeffect,calledembeddinganinterface,isequivalenttoenumeratingthemethodsofTexplicitlyintheinterface.typeReadWriteinterface{Read(bBuffer)boolWrite(bBuffer)bool}typeFileinterface{ReadWrite//sameasenumeratingthemethodsinReadWriteLock//sameasenumeratingthemethodsinLockClose()}AninterfacetypeTmaynotembeditselforanyinterfacetypethatembedsT,recursively.//illegal:BadcannotembeditselftypeBadinterface{Bad}//illegal:Bad1cannotembeditselfusingBad2typeBad1interface{Bad2}typeBad2interface{Bad1}MaptypesAmapisanunorderedgroupofelementsofonetype,calledtheelementtype,indexedbyasetofuniquekeysofanothertype,calledthekeytype.Thevalueofanuninitializedmapisnil.MapType="map""["KeyType"]"ElementType.KeyType=Type.Thecomparisonoperators==and!=mustbefullydefinedforoperandsofthekeytype;thusthekeytypemustnotbeafunction,map,orslice.Ifthekeytypeisaninterfacetype,thesecomparisonoperatorsmustbedefinedforthedynamickeyvalues;failurewillcausearun-timepanic.map[string]intmap[*T]struct{x,yfloat64}map[string]interface{}Thenumberofmapelementsiscalleditslength.Foramapm,itcanbediscoveredusingthebuilt-infunctionlenandmaychangeduringexecution.Elementsmaybeaddedduringexecutionusingassignmentsandretrievedwithindexexpressions;theymayberemovedwiththedeletebuilt-infunction.Anew,emptymapvalueismadeusingthebuilt-infunctionmake,whichtakesthemaptypeandanoptionalcapacityhintasarguments:make(map[string]int)make(map[string]int,100)Theinitialcapacitydoesnotbounditssize:mapsgrowtoaccommodatethenumberofitemsstoredinthem,withtheexceptionofnilmaps.Anilmapisequivalenttoanemptymapexceptthatnoelementsmaybeadded.ChanneltypesAchannelprovidesamechanismfortwoconcurrentlyexecutingfunctionstosynchronizeexecutionandcommunicatebypassingavalueofaspecifiedelementtype.Thevalueofanuninitializedchannelisnil.ChannelType=("chan"["<-"]|"<-""chan")ElementType.The<-operatorspecifiesthechanneldirection,sendorreceive.Ifnodirectionisgiven,thechannelisbi-directional.Achannelmaybeconstrainedonlytosendoronlytoreceivebyconversionorassignment.chanT//canbeusedtosendandreceivevaluesoftypeTchan<-float64//canonlybeusedtosendfloat64s<-chanint//canonlybeusedtoreceiveintsThe<-operatorassociateswiththeleftmostchanpossible:chan<-chanint//sameaschan<-(chanint)chan<-<-chanint//sameaschan<-(<-chanint)<-chan<-chanint//sameas<-chan(<-chanint)chan(<-chanint)Anew,initializedchannelvaluecanbemadeusingthebuilt-infunctionmake,whichtakesthechanneltypeandanoptionalcapacityasarguments:make(chanint,100)Thecapacity,innumberofelements,setsthesizeofthebufferinthechannel.Ifthecapacityisgreaterthanzero,thechannelisasynchronous:communicationoperationssucceedwithoutblockingifthebufferisnotfull(sends)ornotempty(receives),andelementsarereceivedintheordertheyaresent.Ifthecapacityiszeroorabsent,thecommunicationsucceedsonlywhenbothasenderandreceiverareready.Anilchannelisneverreadyforcommunication.Achannelmaybeclosedwiththebuilt-infunctionclose;themulti-valuedassignmentformofthereceiveoperatortestswhetherachannelhasbeenclosed.PropertiesoftypesandvaluesTypeidentityTwotypesareeitheridenticalordifferent.TwonamedtypesareidenticaliftheirtypenamesoriginateinthesameTypeSpec.Anamedandanunnamedtypearealwaysdifferent.Twounnamedtypesareidenticalifthecorrespondingtypeliteralsareidentical,thatis,iftheyhavethesameliteralstructureandcorrespondingcomponentshaveidenticaltypes.Indetail:Twoarraytypesareidenticaliftheyhaveidenticalelementtypesandthesamearraylength.Twoslicetypesareidenticaliftheyhaveidenticalelementtypes.Twostructtypesareidenticaliftheyhavethesamesequenceoffields,andifcorrespondingfieldshavethesamenames,andidenticaltypes,andidenticaltags.Twoanonymousfieldsareconsideredtohavethesamename.Lower-casefieldnamesfromdifferentpackagesarealwaysdifferent.Twopointertypesareidenticaliftheyhaveidenticalbasetypes.Twofunctiontypesareidenticaliftheyhavethesamenumberofparametersandresultvalues,correspondingparameterandresulttypesareidentical,andeitherbothfunctionsarevariadicorneitheris.Parameterandresultnamesarenotrequiredtomatch.Twointerfacetypesareidenticaliftheyhavethesamesetofmethodswiththesamenamesandidenticalfunctiontypes.Lower-casemethodnamesfromdifferentpackagesarealwaysdifferent.Theorderofthemethodsisirrelevant.Twomaptypesareidenticaliftheyhaveidenticalkeyandvaluetypes.Twochanneltypesareidenticaliftheyhaveidenticalvaluetypesandthesamedirection.Giventhedeclarationstype(T0[]stringT1[]stringT2struct{a,bint}T3struct{a,cint}T4func(int,float64)*T0T5func(xint,yfloat64)*[]string)thesetypesareidentical:T0andT0[]intand[]intstruct{a,b*T5}andstruct{a,b*T5}func(xint,yfloat64)*[]stringandfunc(int,float64)(result*[]string)T0andT1aredifferentbecausetheyarenamedtypeswithdistinctdeclarations;func(int,float64)*T0andfunc(xint,yfloat64)*[]stringaredifferentbecauseT0isdifferentfrom[]string.AssignabilityAvaluexisassignabletoavariableoftypeT("xisassignabletoT")inanyofthesecases:x'stypeisidenticaltoT.x'stypeVandThaveidenticalunderlyingtypesandatleastoneofVorTisnotanamedtype.TisaninterfacetypeandximplementsT.xisabidirectionalchannelvalue,Tisachanneltype,x'stypeVandThaveidenticalelementtypes,andatleastoneofVorTisnotanamedtype.xisthepredeclaredidentifiernilandTisapointer,function,slice,map,channel,orinterfacetype.xisanuntypedconstantrepresentablebyavalueoftypeT.BlocksAblockisapossiblyemptysequenceofdeclarationsandstatementswithinmatchingbracebrackets.Block="{"StatementList"}".StatementList={Statement";"}.Inadditiontoexplicitblocksinthesourcecode,thereareimplicitblocks:TheuniverseblockencompassesallGosourcetext.EachpackagehasapackageblockcontainingallGosourcetextforthatpackage.EachfilehasafileblockcontainingallGosourcetextinthatfile.Each"if","for",and"switch"statementisconsideredtobeinitsownimplicitblock.Eachclauseina"switch"or"select"statementactsasanimplicitblock.Blocksnestandinfluencescoping.DeclarationsandscopeAdeclarationbindsanon-blankidentifiertoaconstant,type,variable,function,label,orpackage.Everyidentifierinaprogrammustbedeclared.Noidentifiermaybedeclaredtwiceinthesameblock,andnoidentifiermaybedeclaredinboththefileandpackageblock.Theblankidentifiermaybeusedlikeanyotheridentifierinadeclaration,butitdoesnotintroduceabindingandthusisnotdeclared.Declaration=ConstDecl|TypeDecl|VarDecl.TopLevelDecl=Declaration|FunctionDecl|MethodDecl.Thescopeofadeclaredidentifieristheextentofsourcetextinwhichtheidentifierdenotesthespecifiedconstant,type,variable,function,label,orpackage.Goislexicallyscopedusingblocks:Thescopeofapredeclaredidentifieristheuniverseblock.Thescopeofanidentifierdenotingaconstant,type,variable,orfunction(butnotmethod)declaredattoplevel(outsideanyfunction)isthepackageblock.Thescopeofthepackagenameofanimportedpackageisthefileblockofthefilecontainingtheimportdeclaration.Thescopeofanidentifierdenotingamethodreceiver,functionparameter,orresultvariableisthefunctionbody.ThescopeofaconstantorvariableidentifierdeclaredinsideafunctionbeginsattheendoftheConstSpecorVarSpec(ShortVarDeclforshortvariabledeclarations)andendsattheendoftheinnermostcontainingblock.ThescopeofatypeidentifierdeclaredinsideafunctionbeginsattheidentifierintheTypeSpecandendsattheendoftheinnermostcontainingblock.Anidentifierdeclaredinablockmayberedeclaredinaninnerblock.Whiletheidentifieroftheinnerdeclarationisinscope,itdenotestheentitydeclaredbytheinnerdeclaration.Thepackageclauseisnotadeclaration;thepackagenamedoesnotappearinanyscope.Itspurposeistoidentifythefilesbelongingtothesamepackageandtospecifythedefaultpackagenameforimportdeclarations.LabelscopesLabelsaredeclaredbylabeledstatementsandareusedinthe"break","continue",and"goto"statements.Itisillegaltodefinealabelthatisneverused.Incontrasttootheridentifiers,labelsarenotblockscopedanddonotconflictwithidentifiersthatarenotlabels.Thescopeofalabelisthebodyofthefunctioninwhichitisdeclaredandexcludesthebodyofanynestedfunction.BlankidentifierTheblankidentifierisrepresentedbytheunderscorecharacter_.Itservesasananonymousplaceholderinsteadofaregular(non-blank)identifierandhasspecialmeaningindeclarations,asanoperand,andinassignments.PredeclaredidentifiersThefollowingidentifiersareimplicitlydeclaredintheuniverseblock:Types:boolbytecomplex64complex128errorfloat32float64intint8int16int32int64runestringuintuint8uint16uint32uint64uintptrConstants:truefalseiotaZerovalue:nilFunctions:appendcapclosecomplexcopydeleteimaglenmakenewpanicprintprintlnrealrecoverExportedidentifiersAnidentifiermaybeexportedtopermitaccesstoitfromanotherpackage.Anidentifierisexportedifboth:thefirstcharacteroftheidentifier'snameisaUnicodeuppercaseletter(Unicodeclass"Lu");andtheidentifierisdeclaredinthepackageblockoritisafieldnameormethodname.Allotheridentifiersarenotexported.UniquenessofidentifiersGivenasetofidentifiers,anidentifieriscalleduniqueifitisdifferentfromeveryotherintheset.Twoidentifiersaredifferentiftheyarespelleddifferently,oriftheyappearindifferentpackagesandarenotexported.Otherwise,theyarethesame.ConstantdeclarationsAconstantdeclarationbindsalistofidentifiers(thenamesoftheconstants)tothevaluesofalistofconstantexpressions.Thenumberofidentifiersmustbeequaltothenumberofexpressions,andthenthidentifierontheleftisboundtothevalueofthenthexpressionontheright.ConstDecl="const"(ConstSpec|"("{ConstSpec";"}")").ConstSpec=IdentifierList[[Type]"="ExpressionList].IdentifierList=identifier{","identifier}.ExpressionList=Expression{","Expression}.Ifthetypeispresent,allconstantstakethetypespecified,andtheexpressionsmustbeassignabletothattype.Ifthetypeisomitted,theconstantstaketheindividualtypesofthecorrespondingexpressions.Iftheexpressionvaluesareuntypedconstants,thedeclaredconstantsremainuntypedandtheconstantidentifiersdenotetheconstantvalues.Forinstance,iftheexpressionisafloating-pointliteral,theconstantidentifierdenotesafloating-pointconstant,eveniftheliteral'sfractionalpartiszero.constPifloat64=3.14159265358979323846constzero=0.0//untypedfloating-pointconstantconst(sizeint64=1024eof=-1//untypedintegerconstant)consta,b,c=3,4,"foo"//a=3,b=4,c="foo",untypedintegerandstringconstantsconstu,vfloat32=0,3//u=0.0,v=3.0Withinaparenthesizedconstdeclarationlisttheexpressionlistmaybeomittedfromanybutthefirstdeclaration.Suchanemptylistisequivalenttothetextualsubstitutionofthefirstprecedingnon-emptyexpressionlistanditstypeifany.Omittingthelistofexpressionsisthereforeequivalenttorepeatingthepreviouslist.Thenumberofidentifiersmustbeequaltothenumberofexpressionsinthepreviouslist.Togetherwiththeiotaconstantgeneratorthismechanismpermitslight-weightdeclarationofsequentialvalues:const(Sunday=iotaMondayTuesdayWednesdayThursdayFridayPartydaynumberOfDays//thisconstantisnotexported)IotaWithinaconstantdeclaration,thepredeclaredidentifieriotarepresentssuccessiveuntypedintegerconstants.Itisresetto0wheneverthereservedwordconstappearsinthesourceandincrementsaftereachConstSpec.Itcanbeusedtoconstructasetofrelatedconstants:const(//iotaisresetto0c0=iota//c0==0c1=iota//c1==1c2=iota//c2==2)const(a=1<<iota//a==1(iotahasbeenreset)b=1<<iota//b==2c=1<<iota//c==4)const(u=iota*42//u==0(untypedintegerconstant)vfloat64=iota*42//v==42.0(float64constant)w=iota*42//w==84(untypedintegerconstant))constx=iota//x==0(iotahasbeenreset)consty=iota//y==0(iotahasbeenreset)WithinanExpressionList,thevalueofeachiotaisthesamebecauseitisonlyincrementedaftereachConstSpec:const(bit0,mask0=1<<iota,1<<iota-1//bit0==1,mask0==0bit1,mask1//bit1==2,mask1==1_,_//skipsiota==2bit3,mask3//bit3==8,mask3==7)Thislastexampleexploitstheimplicitrepetitionofthelastnon-emptyexpressionlist.TypedeclarationsAtypedeclarationbindsanidentifier,thetypename,toanewtypethathasthesameunderlyingtypeasanexistingtype.Thenewtypeisdifferentfromtheexistingtype.TypeDecl="type"(TypeSpec|"("{TypeSpec";"}")").TypeSpec=identifierType.typeIntArray[16]inttype(Pointstruct{x,yfloat64}PolarPoint)typeTreeNodestruct{left,right*TreeNodevalue*Comparable}typeBlockinterface{BlockSize()intEncrypt(src,dst[]byte)Decrypt(src,dst[]byte)}Thedeclaredtypedoesnotinheritanymethodsboundtotheexistingtype,butthemethodsetofaninterfacetypeorofelementsofacompositetyperemainsunchanged://AMutexisadatatypewithtwomethods,LockandUnlock.typeMutexstruct{/*Mutexfields*/}func(m*Mutex)Lock(){/*Lockimplementation*/}func(m*Mutex)Unlock(){/*Unlockimplementation*/}//NewMutexhasthesamecompositionasMutexbutitsmethodsetisempty.typeNewMutexMutex//ThemethodsetofthebasetypeofPtrMutexremainsunchanged,//butthemethodsetofPtrMutexisempty.typePtrMutex*Mutex//Themethodsetof*PrintableMutexcontainsthemethods//LockandUnlockboundtoitsanonymousfieldMutex.typePrintableMutexstruct{Mutex}//MyBlockisaninterfacetypethathasthesamemethodsetasBlock.typeMyBlockBlockAtypedeclarationmaybeusedtodefineadifferentboolean,numeric,orstringtypeandattachmethodstoit:typeTimeZoneintconst(ESTTimeZone=-(5+iota)CSTMSTPST)func(tzTimeZone)String()string{returnfmt.Sprintf("GMT+%dh",tz)}VariabledeclarationsAvariabledeclarationcreatesavariable,bindsanidentifiertoitandgivesitatypeandoptionallyaninitialvalue.VarDecl="var"(VarSpec|"("{VarSpec";"}")").VarSpec=IdentifierList(Type["="ExpressionList]|"="ExpressionList).variintvarU,V,Wfloat64vark=0varx,yfloat32=-1,-2var(iintu,v,s=2.0,3.0,"bar")varre,im=complexSqrt(-1)var_,found=entries[name]//maplookup;onlyinterestedin"found"Ifalistofexpressionsisgiven,thevariablesareinitializedbyassigningtheexpressionstothevariablesinorder;allexpressionsmustbeconsumedandallvariablesinitializedfromthem.Otherwise,eachvariableisinitializedtoitszerovalue.Ifthetypeispresent,eachvariableisgiventhattype.Otherwise,thetypesarededucedfromtheassignmentoftheexpressionlist.Ifthetypeisabsentandthecorrespondingexpressionevaluatestoanuntypedconstant,thetypeofthedeclaredvariableisasdescribedin§Assignments.Implementationrestriction:Acompilermaymakeitillegaltodeclareavariableinsideafunctionbodyifthevariableisneverused.ShortvariabledeclarationsAshortvariabledeclarationusesthesyntax:ShortVarDecl=IdentifierList":="ExpressionList.Itisshorthandforaregularvariabledeclarationwithinitializerexpressionsbutnotypes:"var"IdentifierList=ExpressionList.i,j:=0,10f:=func()int{return7}ch:=make(chanint)r,w:=os.Pipe(fd)//os.Pipe()returnstwovalues_,y,_:=coord(p)//coord()returnsthreevalues;onlyinterestedinycoordinateUnlikeregularvariabledeclarations,ashortvariabledeclarationmayredeclarevariablesprovidedtheywereoriginallydeclaredearlierinthesameblockwiththesametype,andatleastoneofthenon-blankvariablesisnew.Asaconsequence,redeclarationcanonlyappearinamulti-variableshortdeclaration.Redeclarationdoesnotintroduceanewvariable;itjustassignsanewvaluetotheoriginal.field1,offset:=nextField(str,0)field2,offset:=nextField(str,offset)//redeclaresoffseta,a:=1,2//illegal:doubledeclarationofaornonewvariableifawasdeclaredelsewhereShortvariabledeclarationsmayappearonlyinsidefunctions.Insomecontextssuchastheinitializersfor"if","for",or"switch"statements,theycanbeusedtodeclarelocaltemporaryvariables.FunctiondeclarationsAfunctiondeclarationbindsanidentifier,thefunctionname,toafunction.FunctionDecl="func"FunctionName(Function|Signature).FunctionName=identifier.Function=SignatureFunctionBody.FunctionBody=Block.Ifthefunction'ssignaturedeclaresresultparameters,thefunctionbody'sstatementlistmustendinaterminatingstatement.funcfindMarker(c<-chanint)int{fori:=rangec{ifx:=<-c;isMarker(x){returnx}}//invalid:missingreturnstatement.}Afunctiondeclarationmayomitthebody.SuchadeclarationprovidesthesignatureforafunctionimplementedoutsideGo,suchasanassemblyroutine.funcmin(xint,yint)int{ifx<y{returnx}returny}funcflushICache(begin,enduintptr)//implementedexternallyMethoddeclarationsAmethodisafunctionwithareceiver.Amethoddeclarationbindsanidentifier,themethodname,toamethod,andassociatesthemethodwiththereceiver'sbasetype.MethodDecl="func"ReceiverMethodName(Function|Signature).Receiver="("[identifier]["*"]BaseTypeName")".BaseTypeName=identifier.ThereceivertypemustbeoftheformTor*TwhereTisatypename.ThetypedenotedbyTiscalledthereceiverbasetype;itmustnotbeapointerorinterfacetypeanditmustbedeclaredinthesamepackageasthemethod.Themethodissaidtobeboundtothebasetypeandthemethodnameisvisibleonlywithinselectorsforthattype.Anon-blankreceiveridentifiermustbeuniqueinthemethodsignature.Ifthereceiver'svalueisnotreferencedinsidethebodyofthemethod,itsidentifiermaybeomittedinthedeclaration.Thesameappliesingeneraltoparametersoffunctionsandmethods.Forabasetype,thenon-blanknamesofmethodsboundtoitmustbeunique.Ifthebasetypeisastructtype,thenon-blankmethodandfieldnamesmustbedistinct.GiventypePoint,thedeclarationsfunc(p*Point)Length()float64{returnmath.Sqrt(p.x*p.x+p.y*p.y)}func(p*Point)Scale(factorfloat64){p.x*=factorp.y*=factor}bindthemethodsLengthandScale,withreceivertype*Point,tothebasetypePoint.Thetypeofamethodisthetypeofafunctionwiththereceiverasfirstargument.Forinstance,themethodScalehastypefunc(p*Point,factorfloat64)However,afunctiondeclaredthiswayisnotamethod.ExpressionsAnexpressionspecifiesthecomputationofavaluebyapplyingoperatorsandfunctionstooperands.OperandsOperandsdenotetheelementaryvaluesinanexpression.Anoperandmaybealiteral,a(possiblyqualified)non-blankidentifierdenotingaconstant,variable,orfunction,amethodexpressionyieldingafunction,oraparenthesizedexpression.Theblankidentifiermayappearasanoperandonlyontheleft-handsideofanassignment.Operand=Literal|OperandName|MethodExpr|"("Expression")".Literal=BasicLit|CompositeLit|FunctionLit.BasicLit=int_lit|float_lit|imaginary_lit|rune_lit|string_lit.OperandName=identifier|QualifiedIdent.QualifiedidentifiersAqualifiedidentifierisanidentifierqualifiedwithapackagenameprefix.Boththepackagenameandtheidentifiermustnotbeblank.QualifiedIdent=PackageName"."identifier.Aqualifiedidentifieraccessesanidentifierinadifferentpackage,whichmustbeimported.Theidentifiermustbeexportedanddeclaredinthepackageblockofthatpackage.math.Sin//denotestheSinfunctioninpackagemathCompositeliteralsCompositeliteralsconstructvaluesforstructs,arrays,slices,andmapsandcreateanewvalueeachtimetheyareevaluated.Theyconsistofthetypeofthevaluefollowedbyabrace-boundlistofcompositeelements.Anelementmaybeasingleexpressionorakey-valuepair.CompositeLit=LiteralTypeLiteralValue.LiteralType=StructType|ArrayType|"[""...""]"ElementType|SliceType|MapType|TypeName.LiteralValue="{"[ElementList[","]]"}".ElementList=Element{","Element}.Element=[Key":"]Value.Key=FieldName|ElementIndex.FieldName=identifier.ElementIndex=Expression.Value=Expression|LiteralValue.TheLiteralTypemustbeastruct,array,slice,ormaptype(thegrammarenforcesthisconstraintexceptwhenthetypeisgivenasaTypeName).Thetypesoftheexpressionsmustbeassignabletotherespectivefield,element,andkeytypesoftheLiteralType;thereisnoadditionalconversion.Thekeyisinterpretedasafieldnameforstructliterals,anindexforarrayandsliceliterals,andakeyformapliterals.Formapliterals,allelementsmusthaveakey.Itisanerrortospecifymultipleelementswiththesamefieldnameorconstantkeyvalue.Forstructliteralsthefollowingrulesapply:AkeymustbeafieldnamedeclaredintheLiteralType.Anelementlistthatdoesnotcontainanykeysmustlistanelementforeachstructfieldintheorderinwhichthefieldsaredeclared.Ifanyelementhasakey,everyelementmusthaveakey.Anelementlistthatcontainskeysdoesnotneedtohaveanelementforeachstructfield.Omittedfieldsgetthezerovalueforthatfield.Aliteralmayomittheelementlist;suchaliteralevaluatestothezerovalueforitstype.Itisanerrortospecifyanelementforanon-exportedfieldofastructbelongingtoadifferentpackage.GiventhedeclarationstypePoint3Dstruct{x,y,zfloat64}typeLinestruct{p,qPoint3D}onemaywriteorigin:=Point3D{}//zerovalueforPoint3Dline:=Line{origin,Point3D{y:-4,z:12.3}}//zerovalueforline.q.xForarrayandsliceliteralsthefollowingrulesapply:Eachelementhasanassociatedintegerindexmarkingitspositioninthearray.Anelementwithakeyusesthekeyasitsindex;thekeymustbeaconstantintegerexpression.Anelementwithoutakeyusesthepreviouselement'sindexplusone.Ifthefirstelementhasnokey,itsindexiszero.Takingtheaddressofacompositeliteralgeneratesapointertoauniqueinstanceoftheliteral'svalue.varpointer*Point3D=&Point3D{y:1000}ThelengthofanarrayliteralisthelengthspecifiedintheLiteralType.Iffewerelementsthanthelengthareprovidedintheliteral,themissingelementsaresettothezerovalueforthearrayelementtype.Itisanerrortoprovideelementswithindexvaluesoutsidetheindexrangeofthearray.Thenotation...specifiesanarraylengthequaltothemaximumelementindexplusone.buffer:=[10]string{}//len(buffer)==10intSet:=[6]int{1,2,3,5}//len(intSet)==6days:=[...]string{"Sat","Sun"}//len(days)==2Asliceliteraldescribestheentireunderlyingarrayliteral.Thus,thelengthandcapacityofasliceliteralarethemaximumelementindexplusone.Asliceliteralhastheform[]T{x1,x2,…xn}andisshorthandforasliceoperationappliedtoanarray:tmp:=[n]T{x1,x2,…xn}tmp[0:n]Withinacompositeliteralofarray,slice,ormaptypeT,elementsthatarethemselvescompositeliteralsmayelidetherespectiveliteraltypeifitisidenticaltotheelementtypeofT.Similarly,elementsthatareaddressesofcompositeliteralsmayelidethe&Twhentheelementtypeis*T.[...]Point{{1.5,-3.5},{0,0}}//sameas[...]Point{Point{1.5,-3.5},Point{0,0}}[][]int{{1,2,3},{4,5}}//sameas[][]int{[]int{1,2,3},[]int{4,5}}[...]*Point{{1.5,-3.5},{0,0}}//sameas[...]*Point{&Point{1.5,-3.5},&Point{0,0}}AparsingambiguityariseswhenacompositeliteralusingtheTypeNameformoftheLiteralTypeappearsbetweenthekeywordandtheopeningbraceoftheblockofan"if","for",or"switch"statement,becausethebracessurroundingtheexpressionsintheliteralareconfusedwiththoseintroducingtheblockofstatements.Toresolvetheambiguityinthisrarecase,thecompositeliteralmustappearwithinparentheses.ifx==(T{a,b,c}[i]){…}if(x==T{a,b,c}[i]){…}Examplesofvalidarray,slice,andmapliterals://listofprimenumbersprimes:=[]int{2,3,5,7,9,2147483647}//vowels[ch]istrueifchisavowelvowels:=[128]bool{'a':true,'e':true,'i':true,'o':true,'u':true,'y':true}//thearray[10]float32{-1,0,0,0,-0.1,-0.1,0,0,0,-1}filter:=[10]float32{-1,4:-0.1,-0.1,9:-1}//frequenciesinHzforequal-temperedscale(A4=440Hz)noteFrequency:=map[string]float32{"C0":16.35,"D0":18.35,"E0":20.60,"F0":21.83,"G0":24.50,"A0":27.50,"B0":30.87,}FunctionliteralsAfunctionliteralrepresentsananonymousfunction.FunctionLit="func"Function.func(a,bint,zfloat64)bool{returna*b<int(z)}Afunctionliteralcanbeassignedtoavariableorinvokeddirectly.f:=func(x,yint)int{returnx+y}func(chchanint){ch<-ACK}(replyChan)Functionliteralsareclosures:theymayrefertovariablesdefinedinasurroundingfunction.Thosevariablesarethensharedbetweenthesurroundingfunctionandthefunctionliteral,andtheysurviveaslongastheyareaccessible.PrimaryexpressionsPrimaryexpressionsaretheoperandsforunaryandbinaryexpressions.PrimaryExpr=Operand|Conversion|BuiltinCall|PrimaryExprSelector|PrimaryExprIndex|PrimaryExprSlice|PrimaryExprTypeAssertion|PrimaryExprCall.Selector="."identifier.Index="["Expression"]".Slice="["([Expression]":"[Expression])|([Expression]":"Expression":"Expression)"]".TypeAssertion=".""("Type")".Call="("[ArgumentList[","]]")".ArgumentList=ExpressionList["..."].x2(s+".txt")f(3.1415,true)Point{1,2}m["foo"]s[i:j+1]obj.colorf.p[i].x()SelectorsForaprimaryexpressionxthatisnotapackagename,theselectorexpressionx.fdenotesthefieldormethodfofthevaluex(orsometimes*x;seebelow).Theidentifierfiscalledthe(fieldormethod)selector;itmustnotbetheblankidentifier.Thetypeoftheselectorexpressionisthetypeoff.Ifxisapackagename,seethesectiononqualifiedidentifiers.AselectorfmaydenoteafieldormethodfofatypeT,oritmayrefertoafieldormethodfofanestedanonymousfieldofT.ThenumberofanonymousfieldstraversedtoreachfiscalleditsdepthinT.ThedepthofafieldormethodfdeclaredinTiszero.ThedepthofafieldormethodfdeclaredinananonymousfieldAinTisthedepthoffinAplusone.Thefollowingrulesapplytoselectors:ForavaluexoftypeTor*TwhereTisnotaninterfacetype,x.fdenotesthefieldormethodattheshallowestdepthinTwherethereissuchanf.Ifthereisnotexactlyonefwithshallowestdepth,theselectorexpressionisillegal.ForavariablexoftypeIwhereIisaninterfacetype,x.fdenotestheactualmethodwithnamefofthevalueassignedtox.IfthereisnomethodwithnamefinthemethodsetofI,theselectorexpressionisillegal.Inallothercases,x.fisillegal.Ifxisofpointertypeandhasthevaluenilandx.fdenotesastructfield,assigningtoorevaluatingx.fcausesarun-timepanic.Ifxisofinterfacetypeandhasthevaluenil,callingorevaluatingthemethodx.fcausesarun-timepanic.Selectorsautomaticallydereferencepointerstostructs.Ifxisapointertoastruct,x.yisshorthandfor(*x).y;ifthefieldyisalsoapointertoastruct,x.y.zisshorthandfor(*(*x).y).z,andsoon.Ifxcontainsananonymousfieldoftype*A,whereAisalsoastructtype,x.fisshorthandfor(*x.A).f.Forexample,giventhedeclarations:typeT0struct{xint}func(recv*T0)M0()typeT1struct{yint}func(recvT1)M1()typeT2struct{zintT1*T0}func(recv*T2)M2()varp*T2//withp!=nilandp.T0!=nilonemaywrite:p.z//(*p).zp.y//((*p).T1).yp.x//(*(*p).T0).xp.M2()//(*p).M2()p.M1()//((*p).T1).M1()p.M0()//((*p).T0).M0()IndexexpressionsAprimaryexpressionoftheforma[x]denotestheelementofthearray,pointertoarray,slice,stringormapaindexedbyx.Thevaluexiscalledtheindexormapkey,respectively.Thefollowingrulesapply:Ifaisnotamap:theindexxmustbeofintegertypeoruntyped;itisinrangeif0<=x<len(a),otherwiseitisoutofrangeaconstantindexmustbenon-negativeandrepresentablebyavalueoftypeintForaofarraytypeA:aconstantindexmustbeinrangeifxisoutofrangeatruntime,arun-timepanicoccursa[x]isthearrayelementatindexxandthetypeofa[x]istheelementtypeofAForaofpointertoarraytype:a[x]isshorthandfor(*a)[x]ForaofslicetypeS:ifxisoutofrangeatruntime,arun-timepanicoccursa[x]isthesliceelementatindexxandthetypeofa[x]istheelementtypeofSForaofstringtype:aconstantindexmustbeinrangeifthestringaisalsoconstantifxisoutofrangeatruntime,arun-timepanicoccursa[x]isthenon-constantbytevalueatindexxandthetypeofa[x]isbytea[x]maynotbeassignedtoForaofmaptypeM:x'stypemustbeassignabletothekeytypeofMifthemapcontainsanentrywithkeyx,a[x]isthemapvaluewithkeyxandthetypeofa[x]isthevaluetypeofMifthemapisnilordoesnotcontainsuchanentry,a[x]isthezerovalueforthevaluetypeofMOtherwisea[x]isillegal.Anindexexpressiononamapaoftypemap[K]Vmaybeusedinanassignmentorinitializationofthespecialformv,ok=a[x]v,ok:=a[x]varv,ok=a[x]wheretheresultoftheindexexpressionisapairofvalueswithtypes(V,bool).Inthisform,thevalueofokistrueifthekeyxispresentinthemap,andfalseotherwise.Thevalueofvisthevaluea[x]asinthesingle-resultform.Assigningtoanelementofanilmapcausesarun-timepanic.SliceexpressionsSliceexpressionsconstructasubstringorslicefromastring,array,pointertoarray,orslice.Therearetwovariants:asimpleformthatspecifiesalowandhighbound,andafullformthatalsospecifiesaboundonthecapacity.SimplesliceexpressionsForastring,array,pointertoarray,orslicea,theprimaryexpressiona[low:high]constructsasubstringorslice.Theindiceslowandhighselectwhichelementsofoperandaappearintheresult.Theresulthasindicesstartingat0andlengthequaltohigh-low.Afterslicingthearrayaa:=[5]int{1,2,3,4,5}s:=a[1:4]thesliceshastype[]int,length3,capacity4,andelementss[0]==2s[1]==3s[2]==4Forconvenience,anyoftheindicesmaybeomitted.Amissinglowindexdefaultstozero;amissinghighindexdefaultstothelengthoftheslicedoperand:a[2:]//sameasa[2:len(a)]a[:3]//sameasa[0:3]a[:]//sameasa[0:len(a)]Ifaisapointertoanarray,a[low:high]isshorthandfor(*a)[low:high].Forarraysorstrings,theindicesareinrangeif0<=low<=high<=len(a),otherwisetheyareoutofrange.Forslices,theupperindexboundistheslicecapacitycap(a)ratherthanthelength.Aconstantindexmustbenon-negativeandrepresentablebyavalueoftypeint.Ifbothindicesareconstant,theymustsatisfylow<=high.Iftheindicesareoutofrangeatruntime,arun-timepanicoccurs.Exceptforuntypedstrings,iftheslicedoperandisastringorslice,theresultofthesliceoperationisanon-constantvalueofthesametypeastheoperand.Foruntypedstringoperandstheresultisanon-constantvalueoftypestring.Iftheslicedoperandisanarray,itmustbeaddressableandtheresultofthesliceoperationisaslicewiththesameelementtypeasthearray.Iftheslicedoperandofavalidsliceexpressionisanilslice,theresultisanilslice.Otherwise,theresultsharesitsunderlyingarraywiththeoperand.FullsliceexpressionsForanarray,pointertoarray,orslicea(butnotastring),theprimaryexpressiona[low:high:max]constructsasliceofthesametype,andwiththesamelengthandelementsasthesimplesliceexpressiona[low:high].Additionally,itcontrolstheresultingslice'scapacitybysettingittomax-low.Onlythefirstindexmaybeomitted;itdefaultsto0.Afterslicingthearrayaa:=[5]int{1,2,3,4,5}t:=a[1:3:5]theslicethastype[]int,length2,capacity4,andelementst[0]==2t[1]==3Asforsimplesliceexpressions,ifaisapointertoanarray,a[low:high:max]isshorthandfor(*a)[low:high:max].Iftheslicedoperandisanarray,itmustbeaddressable.Theindicesareinrangeif0<=low<=high<=max<=cap(a),otherwisetheyareoutofrange.Aconstantindexmustbenon-negativeandrepresentablebyavalueoftypeint.Ifmultipleindicesareconstant,theconstantsthatarepresentmustbeinrangerelativetoeachother.Iftheindicesareoutofrangeatruntime,arun-timepanicoccurs.TypeassertionsForanexpressionxofinterfacetypeandatypeT,theprimaryexpressionx.(T)assertsthatxisnotnilandthatthevaluestoredinxisoftypeT.Thenotationx.(T)iscalledatypeassertion.Moreprecisely,ifTisnotaninterfacetype,x.(T)assertsthatthedynamictypeofxisidenticaltothetypeT.Inthiscase,Tmustimplementthe(interface)typeofx;otherwisethetypeassertionisinvalidsinceitisnotpossibleforxtostoreavalueoftypeT.IfTisaninterfacetype,x.(T)assertsthatthedynamictypeofximplementstheinterfaceT.Ifthetypeassertionholds,thevalueoftheexpressionisthevaluestoredinxanditstypeisT.Ifthetypeassertionisfalse,arun-timepanicoccurs.Inotherwords,eventhoughthedynamictypeofxisknownonlyatruntime,thetypeofx.(T)isknowntobeTinacorrectprogram.varxinterface{}=7//xhasdynamictypeintandvalue7i:=x.(int)//ihastypeintandvalue7typeIinterface{m()}varyIs:=y.(string)//illegal:stringdoesnotimplementI(missingmethodm)r:=y.(io.Reader)//rhastypeio.ReaderandymustimplementbothIandio.ReaderIfatypeassertionisusedinanassignmentorinitializationoftheformv,ok=x.(T)v,ok:=x.(T)varv,ok=x.(T)theresultoftheassertionisapairofvalueswithtypes(T,bool).Iftheassertionholds,theexpressionreturnsthepair(x.(T),true);otherwise,theexpressionreturns(Z,false)whereZisthezerovaluefortypeT.Norun-timepanicoccursinthiscase.Thetypeassertioninthisconstructthusactslikeafunctioncallreturningavalueandabooleanindicatingsuccess.CallsGivenanexpressionfoffunctiontypeF,f(a1,a2,…an)callsfwithargumentsa1,a2,…an.Exceptforonespecialcase,argumentsmustbesingle-valuedexpressionsassignabletotheparametertypesofFandareevaluatedbeforethefunctioniscalled.ThetypeoftheexpressionistheresulttypeofF.Amethodinvocationissimilarbutthemethoditselfisspecifiedasaselectoruponavalueofthereceivertypeforthemethod.math.Atan2(x,y)//functioncallvarpt*Pointpt.Scale(3.5)//methodcallwithreceiverptInafunctioncall,thefunctionvalueandargumentsareevaluatedintheusualorder.Aftertheyareevaluated,theparametersofthecallarepassedbyvaluetothefunctionandthecalledfunctionbeginsexecution.Thereturnparametersofthefunctionarepassedbyvaluebacktothecallingfunctionwhenthefunctionreturns.Callinganilfunctionvaluecausesarun-timepanic.Asaspecialcase,ifthereturnvaluesofafunctionormethodgareequalinnumberandindividuallyassignabletotheparametersofanotherfunctionormethodf,thenthecallf(g(parameters_of_g))willinvokefafterbindingthereturnvaluesofgtotheparametersoffinorder.Thecalloffmustcontainnoparametersotherthanthecallofg,andgmusthaveatleastonereturnvalue.Iffhasafinal...parameter,itisassignedthereturnvaluesofgthatremainafterassignmentofregularparameters.funcSplit(sstring,posint)(string,string){returns[0:pos],s[pos:]}funcJoin(s,tstring)string{returns+t}ifJoin(Split(value,len(value)/2))!=value{log.Panic("testfails")}Amethodcallx.m()isvalidifthemethodsetof(thetypeof)xcontainsmandtheargumentlistcanbeassignedtotheparameterlistofm.Ifxisaddressableand&x'smethodsetcontainsm,x.m()isshorthandfor(&x).m():varpPointp.Scale(3.5)Thereisnodistinctmethodtypeandtherearenomethodliterals.Passingargumentsto...parametersIffisvariadicwithfinalparametertype...T,thenwithinthefunctiontheargumentisequivalenttoaparameteroftype[]T.Ateachcalloff,theargumentpassedtothefinalparameterisanewsliceoftype[]Twhosesuccessiveelementsaretheactualarguments,whichallmustbeassignabletothetypeT.Thelengthofthesliceisthereforethenumberofargumentsboundtothefinalparameterandmaydifferforeachcallsite.GiventhefunctionandcallfuncGreeting(prefixstring,who...string)Greeting("hello:","Joe","Anna","Eileen")withinGreeting,whowillhavethevalue[]string{"Joe","Anna","Eileen"}Ifthefinalargumentisassignabletoaslicetype[]T,itmaybepassedunchangedasthevaluefora...Tparameteriftheargumentisfollowedby....Inthiscasenonewsliceiscreated.Giventheslicesandcalls:=[]string{"James","Jasmine"}Greeting("goodbye:",s...)withinGreeting,whowillhavethesamevalueasswiththesameunderlyingarray.OperatorsOperatorscombineoperandsintoexpressions.Expression=UnaryExpr|Expressionbinary_opUnaryExpr.UnaryExpr=PrimaryExpr|unary_opUnaryExpr.binary_op="||"|"&&"|rel_op|add_op|mul_op.rel_op="=="|"!="|"<"|"<="|">"|">=".add_op="+"|"-"|"|"|"^".mul_op="*"|"/"|"%"|"<<"|">>"|"&"|"&^".unary_op="+"|"-"|"!"|"^"|"*"|"&"|"<-".Comparisonsarediscussedelsewhere.Forotherbinaryoperators,theoperandtypesmustbeidenticalunlesstheoperationinvolvesshiftsoruntypedconstants.Foroperationsinvolvingconstantsonly,seethesectiononconstantexpressions.Exceptforshiftoperations,ifoneoperandisanuntypedconstantandtheotheroperandisnot,theconstantisconvertedtothetypeoftheotheroperand.Therightoperandinashiftexpressionmusthaveunsignedintegertypeorbeanuntypedconstantthatcanbeconvertedtounsignedintegertype.Iftheleftoperandofanon-constantshiftexpressionisanuntypedconstant,thetypeoftheconstantiswhatitwouldbeiftheshiftexpressionwerereplacedbyitsleftoperandalone.varsuint=33vari=1<<s//1hastypeintvarjint32=1<<s//1hastypeint32;j==0vark=uint64(1<<s)//1hastypeuint64;k==1<<33varmint=1.0<<s//1.0hastypeintvarn=1.0<<s!=i//1.0hastypeint;n==falseifintsare32bitsinsizevaro=1<<s==2<<s//1and2havetypeint;o==trueifintsare32bitsinsizevarp=1<<s==1<<33//illegalifintsare32bitsinsize:1hastypeint,but1<<33overflowsintvaru=1.0<<s//illegal:1.0hastypefloat64,cannotshiftvaru1=1.0<<s!=0//illegal:1.0hastypefloat64,cannotshiftvaru2=1<<s!=1.0//illegal:1hastypefloat64,cannotshiftvarvfloat32=1<<s//illegal:1hastypefloat32,cannotshiftvarwint64=1.0<<33//1.0<<33isaconstantshiftexpressionOperatorprecedenceUnaryoperatorshavethehighestprecedence.Asthe++and--operatorsformstatements,notexpressions,theyfalloutsidetheoperatorhierarchy.Asaconsequence,statement*p++isthesameas(*p)++.Therearefiveprecedencelevelsforbinaryoperators.Multiplicationoperatorsbindstrongest,followedbyadditionoperators,comparisonoperators,&&(logicalAND),andfinally||(logicalOR):PrecedenceOperator5*/%<<>>&&^4+-|^3==!=<<=>>=2&&1||Binaryoperatorsofthesameprecedenceassociatefromlefttoright.Forinstance,x/y*zisthesameas(x/y)*z.+x23+3*x[i]x<=f()^a>>bf()||g()x==y+1&&<-chanPtr>0ArithmeticoperatorsArithmeticoperatorsapplytonumericvaluesandyieldaresultofthesametypeasthefirstoperand.Thefourstandardarithmeticoperators(+,-,*,/)applytointeger,floating-point,andcomplextypes;+alsoappliestostrings.Allotherarithmeticoperatorsapplytointegersonly.+sumintegers,floats,complexvalues,strings-differenceintegers,floats,complexvalues*productintegers,floats,complexvalues/quotientintegers,floats,complexvalues%remainderintegers&bitwiseANDintegers|bitwiseORintegers^bitwiseXORintegers&^bitclear(ANDNOT)integers<<leftshiftinteger<<unsignedinteger>>rightshiftinteger>>unsignedintegerStringscanbeconcatenatedusingthe+operatororthe+=assignmentoperator:s:="hi"+string(c)s+="andgoodbye"Stringadditioncreatesanewstringbyconcatenatingtheoperands.Fortwointegervaluesxandy,theintegerquotientq=x/yandremainderr=x%ysatisfythefollowingrelationships:x=q*y+rand|r|<|y|withx/ytruncatedtowardszero("truncateddivision").xyx/yx%y5312-53-1-25-3-12-5-31-2Asanexceptiontothisrule,ifthedividendxisthemostnegativevaluefortheinttypeofx,thequotientq=x/-1isequaltox(andr=0).x,qint8-128int16-32768int32-2147483648int64-9223372036854775808Ifthedivisorisaconstant,itmustnotbezero.Ifthedivisoriszeroatruntime,arun-timepanicoccurs.Ifthedividendisnon-negativeandthedivisorisaconstantpowerof2,thedivisionmaybereplacedbyarightshift,andcomputingtheremaindermaybereplacedbyabitwiseANDoperation:xx/4x%4x>>2x&3112323-11-2-3-31Theshiftoperatorsshifttheleftoperandbytheshiftcountspecifiedbytherightoperand.Theyimplementarithmeticshiftsiftheleftoperandisasignedintegerandlogicalshiftsifitisanunsignedinteger.Thereisnoupperlimitontheshiftcount.Shiftsbehaveasiftheleftoperandisshiftedntimesby1forashiftcountofn.Asaresult,x<<1isthesameasx*2andx>>1isthesameasx/2buttruncatedtowardsnegativeinfinity.Forintegeroperands,theunaryoperators+,-,and^aredefinedasfollows:+xis0+x-xnegationis0-x^xbitwisecomplementism^xwithm="allbitssetto1"forunsignedxandm=-1forsignedxForfloating-pointandcomplexnumbers,+xisthesameasx,while-xisthenegationofx.Theresultofafloating-pointorcomplexdivisionbyzeroisnotspecifiedbeyondtheIEEE-754standard;whetherarun-timepanicoccursisimplementation-specific.IntegeroverflowForunsignedintegervalues,theoperations+,-,*,and<<arecomputedmodulo2n,wherenisthebitwidthoftheunsignedinteger'stype.Looselyspeaking,theseunsignedintegeroperationsdiscardhighbitsuponoverflow,andprogramsmayrelyon``wraparound''.Forsignedintegers,theoperations+,-,*,and<<maylegallyoverflowandtheresultingvalueexistsandisdeterministicallydefinedbythesignedintegerrepresentation,theoperation,anditsoperands.Noexceptionisraisedasaresultofoverflow.Acompilermaynotoptimizecodeundertheassumptionthatoverflowdoesnotoccur.Forinstance,itmaynotassumethatx<x+1isalwaystrue.ComparisonoperatorsComparisonoperatorscomparetwooperandsandyieldanuntypedbooleanvalue.==equal!=notequal<less<=lessorequal>greater>=greaterorequalInanycomparison,thefirstoperandmustbeassignabletothetypeofthesecondoperand,orviceversa.Theequalityoperators==and!=applytooperandsthatarecomparable.Theorderingoperators<,<=,>,and>=applytooperandsthatareordered.Thesetermsandtheresultofthecomparisonsaredefinedasfollows:Booleanvaluesarecomparable.Twobooleanvaluesareequaliftheyareeitherbothtrueorbothfalse.Integervaluesarecomparableandordered,intheusualway.Floatingpointvaluesarecomparableandordered,asdefinedbytheIEEE-754standard.Complexvaluesarecomparable.Twocomplexvaluesuandvareequalifbothreal(u)==real(v)andimag(u)==imag(v).Stringvaluesarecomparableandordered,lexicallybyte-wise.Pointervaluesarecomparable.Twopointervaluesareequaliftheypointtothesamevariableorifbothhavevaluenil.Pointerstodistinctzero-sizevariablesmayormaynotbeequal.Channelvaluesarecomparable.Twochannelvaluesareequaliftheywerecreatedbythesamecalltomakeorifbothhavevaluenil.Interfacevaluesarecomparable.Twointerfacevaluesareequaliftheyhaveidenticaldynamictypesandequaldynamicvaluesorifbothhavevaluenil.Avaluexofnon-interfacetypeXandavaluetofinterfacetypeTarecomparablewhenvaluesoftypeXarecomparableandXimplementsT.Theyareequalift'sdynamictypeisidenticaltoXandt'sdynamicvalueisequaltox.Structvaluesarecomparableifalltheirfieldsarecomparable.Twostructvaluesareequaliftheircorrespondingnon-blankfieldsareequal.Arrayvaluesarecomparableifvaluesofthearrayelementtypearecomparable.Twoarrayvaluesareequaliftheircorrespondingelementsareequal.Acomparisonoftwointerfacevalueswithidenticaldynamictypescausesarun-timepanicifvaluesofthattypearenotcomparable.Thisbehaviorappliesnotonlytodirectinterfacevaluecomparisonsbutalsowhencomparingarraysofinterfacevaluesorstructswithinterface-valuedfields.Slice,map,andfunctionvaluesarenotcomparable.However,asaspecialcase,aslice,map,orfunctionvaluemaybecomparedtothepredeclaredidentifiernil.Comparisonofpointer,channel,andinterfacevaluestonilisalsoallowedandfollowsfromthegeneralrulesabove.constc=3<4//cistheuntypedboolconstanttruetypeMyBoolboolvarx,yintvar(//Theresultofacomparisonisanuntypedbool.//Theusualassignmentrulesapply.b3=x==y//b3hastypeboolb4bool=x==y//b4hastypeboolb5MyBool=x==y//b5hastypeMyBool)LogicaloperatorsLogicaloperatorsapplytobooleanvaluesandyieldaresultofthesametypeastheoperands.Therightoperandisevaluatedconditionally.&&conditionalANDp&&qis"ifpthenqelsefalse"||conditionalORp||qis"ifpthentrueelseq"!NOT!pis"notp"AddressoperatorsForanoperandxoftypeT,theaddressoperation&xgeneratesapointeroftype*Ttox.Theoperandmustbeaddressable,thatis,eitheravariable,pointerindirection,orsliceindexingoperation;orafieldselectorofanaddressablestructoperand;oranarrayindexingoperationofanaddressablearray.Asanexceptiontotheaddressabilityrequirement,xmayalsobea(possiblyparenthesized)compositeliteral.Iftheevaluationofxwouldcausearun-timepanic,thentheevaluationof&xdoestoo.Foranoperandxofpointertype*T,thepointerindirection*xdenotesthevalueoftypeTpointedtobyx.Ifxisnil,anattempttoevaluate*xwillcausearun-timepanic.&x&a[f(2)]&Point{2,3}*p*pf(x)varx*int=nil*x//causesarun-timepanic&*x//causesarun-timepanicReceiveoperatorForanoperandchofchanneltype,thevalueofthereceiveoperation<-chisthevaluereceivedfromthechannelch.Thechanneldirectionmustpermitreceiveoperations,andthetypeofthereceiveoperationistheelementtypeofthechannel.Theexpressionblocksuntilavalueisavailable.Receivingfromanilchannelblocksforever.Areceiveoperationonaclosedchannelcanalwaysproceedimmediately,yieldingtheelementtype'szerovalue.v1:=<-chv2=<-chf(<-ch)<-strobe//waituntilclockpulseanddiscardreceivedvalueAreceiveexpressionusedinanassignmentorinitializationoftheformx,ok=<-chx,ok:=<-chvarx,ok=<-chyieldsanadditionalresultoftypeboolreportingwhetherthecommunicationsucceeded.Thevalueofokistrueifthevaluereceivedwasdeliveredbyasuccessfulsendoperationtothechannel,orfalseifitisazerovaluegeneratedbecausethechannelisclosedandempty.MethodexpressionsIfMisinthemethodsetoftypeT,T.MisafunctionthatiscallableasaregularfunctionwiththesameargumentsasMprefixedbyanadditionalargumentthatisthereceiverofthemethod.MethodExpr=ReceiverType"."MethodName.ReceiverType=TypeName|"(""*"TypeName")"|"("ReceiverType")".ConsiderastructtypeTwithtwomethods,Mv,whosereceiverisoftypeT,andMp,whosereceiverisoftype*T.typeTstruct{aint}func(tvT)Mv(aint)int{return0}//valuereceiverfunc(tp*T)Mp(ffloat32)float32{return1}//pointerreceivervartTTheexpressionT.MvyieldsafunctionequivalenttoMvbutwithanexplicitreceiverasitsfirstargument;ithassignaturefunc(tvT,aint)intThatfunctionmaybecallednormallywithanexplicitreceiver,sothesefiveinvocationsareequivalent:t.Mv(7)T.Mv(t,7)(T).Mv(t,7)f1:=T.Mv;f1(t,7)f2:=(T).Mv;f2(t,7)Similarly,theexpression(*T).MpyieldsafunctionvaluerepresentingMpwithsignaturefunc(tp*T,ffloat32)float32Foramethodwithavaluereceiver,onecanderiveafunctionwithanexplicitpointerreceiver,so(*T).MvyieldsafunctionvaluerepresentingMvwithsignaturefunc(tv*T,aint)intSuchafunctionindirectsthroughthereceivertocreateavaluetopassasthereceivertotheunderlyingmethod;themethoddoesnotoverwritethevaluewhoseaddressispassedinthefunctioncall.Thefinalcase,avalue-receiverfunctionforapointer-receivermethod,isillegalbecausepointer-receivermethodsarenotinthemethodsetofthevaluetype.Functionvaluesderivedfrommethodsarecalledwithfunctioncallsyntax;thereceiverisprovidedasthefirstargumenttothecall.Thatis,givenf:=T.Mv,fisinvokedasf(t,7)nott.f(7).Toconstructafunctionthatbindsthereceiver,useafunctionliteralormethodvalue.Itislegaltoderiveafunctionvaluefromamethodofaninterfacetype.Theresultingfunctiontakesanexplicitreceiverofthatinterfacetype.MethodvaluesIftheexpressionxhasstatictypeTandMisinthemethodsetoftypeT,x.Miscalledamethodvalue.Themethodvaluex.Misafunctionvaluethatiscallablewiththesameargumentsasamethodcallofx.M.Theexpressionxisevaluatedandsavedduringtheevaluationofthemethodvalue;thesavedcopyisthenusedasthereceiverinanycalls,whichmaybeexecutedlater.ThetypeTmaybeaninterfaceornon-interfacetype.Asinthediscussionofmethodexpressionsabove,considerastructtypeTwithtwomethods,Mv,whosereceiverisoftypeT,andMp,whosereceiverisoftype*T.typeTstruct{aint}func(tvT)Mv(aint)int{return0}//valuereceiverfunc(tp*T)Mp(ffloat32)float32{return1}//pointerreceivervartTvarpt*TfuncmakeT()TTheexpressiont.Mvyieldsafunctionvalueoftypefunc(int)intThesetwoinvocationsareequivalent:t.Mv(7)f:=t.Mv;f(7)Similarly,theexpressionpt.Mpyieldsafunctionvalueoftypefunc(float32)float32Aswithselectors,areferencetoanon-interfacemethodwithavaluereceiverusingapointerwillautomaticallydereferencethatpointer:pt.Mvisequivalentto(*pt).Mv.Aswithmethodcalls,areferencetoanon-interfacemethodwithapointerreceiverusinganaddressablevaluewillautomaticallytaketheaddressofthatvalue:t.Mpisequivalentto(&t).Mp.f:=t.Mv;f(7)//liket.Mv(7)f:=pt.Mp;f(7)//likept.Mp(7)f:=pt.Mv;f(7)//like(*pt).Mv(7)f:=t.Mp;f(7)//like(&t).Mp(7)f:=makeT().Mp//invalid:resultofmakeT()isnotaddressableAlthoughtheexamplesaboveusenon-interfacetypes,itisalsolegaltocreateamethodvaluefromavalueofinterfacetype.variinterface{M(int)}=myValf:=i.M;f(7)//likei.M(7)ConversionsConversionsareexpressionsoftheformT(x)whereTisatypeandxisanexpressionthatcanbeconvertedtotypeT.Conversion=Type"("Expression[","]")".Ifthetypestartswiththeoperator*or<-,orifthetypestartswiththekeywordfuncandhasnoresultlist,itmustbeparenthesizedwhennecessarytoavoidambiguity:*Point(p)//sameas*(Point(p))(*Point)(p)//pisconvertedto*Point<-chanint(c)//sameas<-(chanint(c))(<-chanint)(c)//cisconvertedto<-chanintfunc()(x)//functionsignaturefunc()x(func())(x)//xisconvertedtofunc()(func()int)(x)//xisconvertedtofunc()intfunc()int(x)//xisconvertedtofunc()int(unambiguous)AconstantvaluexcanbeconvertedtotypeTinanyofthesecases:xisrepresentablebyavalueoftypeT.xisafloating-pointconstant,Tisafloating-pointtype,andxisrepresentablebyavalueoftypeTafterroundingusingIEEE754round-to-evenrules.TheconstantT(x)istheroundedvalue.xisanintegerconstantandTisastringtype.Thesameruleasfornon-constantxappliesinthiscase.Convertingaconstantyieldsatypedconstantasresult.uint(iota)//iotavalueoftypeuintfloat32(2.718281828)//2.718281828oftypefloat32complex128(1)//1.0+0.0ioftypecomplex128float32(0.49999999)//0.5oftypefloat32string('x')//"x"oftypestringstring(0x266c)//"♬"oftypestringMyString("foo"+"bar")//"foobar"oftypeMyStringstring([]byte{'a'})//notaconstant:[]byte{'a'}isnotaconstant(*int)(nil)//notaconstant:nilisnotaconstant,*intisnotaboolean,numeric,orstringtypeint(1.2)//illegal:1.2cannotberepresentedasanintstring(65.0)//illegal:65.0isnotanintegerconstantAnon-constantvaluexcanbeconvertedtotypeTinanyofthesecases:xisassignabletoT.x'stypeandThaveidenticalunderlyingtypes.x'stypeandTareunnamedpointertypesandtheirpointerbasetypeshaveidenticalunderlyingtypes.x'stypeandTarebothintegerorfloatingpointtypes.x'stypeandTarebothcomplextypes.xisanintegerorasliceofbytesorrunesandTisastringtype.xisastringandTisasliceofbytesorrunes.Specificrulesapplyto(non-constant)conversionsbetweennumerictypesortoandfromastringtype.Theseconversionsmaychangetherepresentationofxandincurarun-timecost.Allotherconversionsonlychangethetypebutnottherepresentationofx.Thereisnolinguisticmechanismtoconvertbetweenpointersandintegers.Thepackageunsafeimplementsthisfunctionalityunderrestrictedcircumstances.ConversionsbetweennumerictypesFortheconversionofnon-constantnumericvalues,thefollowingrulesapply:Whenconvertingbetweenintegertypes,ifthevalueisasignedinteger,itissignextendedtoimplicitinfiniteprecision;otherwiseitiszeroextended.Itisthentruncatedtofitintheresulttype'ssize.Forexample,ifv:=uint16(0x10F0),thenuint32(int8(v))==0xFFFFFFF0.Theconversionalwaysyieldsavalidvalue;thereisnoindicationofoverflow.Whenconvertingafloating-pointnumbertoaninteger,thefractionisdiscarded(truncationtowardszero).Whenconvertinganintegerorfloating-pointnumbertoafloating-pointtype,oracomplexnumbertoanothercomplextype,theresultvalueisroundedtotheprecisionspecifiedbythedestinationtype.Forinstance,thevalueofavariablexoftypefloat32maybestoredusingadditionalprecisionbeyondthatofanIEEE-75432-bitnumber,butfloat32(x)representstheresultofroundingx'svalueto32-bitprecision.Similarly,x+0.1mayusemorethan32bitsofprecision,butfloat32(x+0.1)doesnot.Inallnon-constantconversionsinvolvingfloating-pointorcomplexvalues,iftheresulttypecannotrepresentthevaluetheconversionsucceedsbuttheresultvalueisimplementation-dependent.ConversionstoandfromastringtypeConvertingasignedorunsignedintegervaluetoastringtypeyieldsastringcontainingtheUTF-8representationoftheinteger.ValuesoutsidetherangeofvalidUnicodecodepointsareconvertedto"\uFFFD".string('a')//"a"string(-1)//"\ufffd"=="\xef\xbf\xbd"string(0xf8)//"\u00f8"=="ø"=="\xc3\xb8"typeMyStringstringMyString(0x65e5)//"\u65e5"=="日"=="\xe6\x97\xa5"Convertingasliceofbytestoastringtypeyieldsastringwhosesuccessivebytesaretheelementsoftheslice.string([]byte{'h','e','l','l','\xc3','\xb8'})//"hellø"string([]byte{})//""string([]byte(nil))//""typeMyBytes[]bytestring(MyBytes{'h','e','l','l','\xc3','\xb8'})//"hellø"Convertingasliceofrunestoastringtypeyieldsastringthatistheconcatenationoftheindividualrunevaluesconvertedtostrings.string([]rune{0x767d,0x9d6c,0x7fd4})//"\u767d\u9d6c\u7fd4"=="白鵬翔"string([]rune{})//""string([]rune(nil))//""typeMyRunes[]runestring(MyRunes{0x767d,0x9d6c,0x7fd4})//"\u767d\u9d6c\u7fd4"=="白鵬翔"Convertingavalueofastringtypetoasliceofbytestypeyieldsaslicewhosesuccessiveelementsarethebytesofthestring.[]byte("hellø")//[]byte{'h','e','l','l','\xc3','\xb8'}[]byte("")//[]byte{}MyBytes("hellø")//[]byte{'h','e','l','l','\xc3','\xb8'}ConvertingavalueofastringtypetoasliceofrunestypeyieldsaslicecontainingtheindividualUnicodecodepointsofthestring.[]rune(MyString("白鵬翔"))//[]rune{0x767d,0x9d6c,0x7fd4}[]rune("")//[]rune{}MyRunes("白鵬翔")//[]rune{0x767d,0x9d6c,0x7fd4}ConstantexpressionsConstantexpressionsmaycontainonlyconstantoperandsandareevaluatedatcompiletime.Untypedboolean,numeric,andstringconstantsmaybeusedasoperandswhereveritislegaltouseanoperandofboolean,numeric,orstringtype,respectively.Exceptforshiftoperations,iftheoperandsofabinaryoperationaredifferentkindsofuntypedconstants,theoperationand,fornon-booleanoperations,theresultusethekindthatappearslaterinthislist:integer,rune,floating-point,complex.Forexample,anuntypedintegerconstantdividedbyanuntypedcomplexconstantyieldsanuntypedcomplexconstant.Aconstantcomparisonalwaysyieldsanuntypedbooleanconstant.Iftheleftoperandofaconstantshiftexpressionisanuntypedconstant,theresultisanintegerconstant;otherwiseitisaconstantofthesametypeastheleftoperand,whichmustbeofintegertype.Applyingallotheroperatorstountypedconstantsresultsinanuntypedconstantofthesamekind(thatis,aboolean,integer,floating-point,complex,orstringconstant).consta=2+3.0//a==5.0(untypedfloating-pointconstant)constb=15/4//b==3(untypedintegerconstant)constc=15/4.0//c==3.75(untypedfloating-pointconstant)constΘfloat64=3/2//Θ==1.0(typefloat64,3/2isintegerdivision)constΠfloat64=3/2.//Π==1.5(typefloat64,3/2.isfloatdivision)constd=1<<3.0//d==8(untypedintegerconstant)conste=1.0<<3//e==8(untypedintegerconstant)constf=int32(1)<<33//illegal(constant8589934592overflowsint32)constg=float64(2)>>1//illegal(float64(2)isatypedfloating-pointconstant)consth="foo">"bar"//h==true(untypedbooleanconstant)constj=true//j==true(untypedbooleanconstant)constk='w'+1//k=='x'(untypedruneconstant)constl="hi"//l=="hi"(untypedstringconstant)constm=string(k)//m=="x"(typestring)constΣ=1-0.707i//(untypedcomplexconstant)constΔ=Σ+2.0e-4//(untypedcomplexconstant)constΦ=iota*1i-1/1i//(untypedcomplexconstant)Applyingthebuilt-infunctioncomplextountypedinteger,rune,orfloating-pointconstantsyieldsanuntypedcomplexconstant.constic=complex(0,c)//ic==3.75i(untypedcomplexconstant)constiΘ=complex(0,Θ)//iΘ==1.5i(typecomplex128)Constantexpressionsarealwaysevaluatedexactly;intermediatevaluesandtheconstantsthemselvesmayrequireprecisionsignificantlylargerthansupportedbyanypredeclaredtypeinthelanguage.Thefollowingarelegaldeclarations:constHuge=1<<100//Huge==1267650600228229401496703205376(untypedintegerconstant)constFourint8=Huge>>98//Four==4(typeint8)Thedivisorofaconstantdivisionorremainderoperationmustnotbezero:3.14/0.0//illegal:divisionbyzeroThevaluesoftypedconstantsmustalwaysbeaccuratelyrepresentableasvaluesoftheconstanttype.Thefollowingconstantexpressionsareillegal:uint(-1)//-1cannotberepresentedasauintint(3.14)//3.14cannotberepresentedasanintint64(Huge)//1267650600228229401496703205376cannotberepresentedasanint64Four*300//operand300cannotberepresentedasanint8(typeofFour)Four*100//product400cannotberepresentedasanint8(typeofFour)Themaskusedbytheunarybitwisecomplementoperator^matchestherulefornon-constants:themaskisall1sforunsignedconstantsand-1forsignedanduntypedconstants.^1//untypedintegerconstant,equalto-2uint8(^1)//illegal:sameasuint8(-2),-2cannotberepresentedasauint8^uint8(1)//typeduint8constant,sameas0xFF^uint8(1)=uint8(0xFE)int8(^1)//sameasint8(-2)^int8(1)//sameas-1^int8(1)=-2Implementationrestriction:Acompilermayuseroundingwhilecomputinguntypedfloating-pointorcomplexconstantexpressions;seetheimplementationrestrictioninthesectiononconstants.Thisroundingmaycauseafloating-pointconstantexpressiontobeinvalidinanintegercontext,evenifitwouldbeintegralwhencalculatedusinginfiniteprecision.OrderofevaluationWhenevaluatingtheoperandsofanexpression,assignment,orreturnstatement,allfunctioncalls,methodcalls,andcommunicationoperationsareevaluatedinlexicalleft-to-rightorder.Forexample,intheassignmenty[f()],ok=g(h(),i()+x[j()],<-c),k()thefunctioncallsandcommunicationhappenintheorderf(),h(),i(),j(),<-c,g(),andk().However,theorderofthoseeventscomparedtotheevaluationandindexingofxandtheevaluationofyisnotspecified.a:=1f:=func()int{a++;returna}x:=[]int{a,f()}//xmaybe[1,2]or[2,2]:evaluationorderbetweenaandf()isnotspecifiedm:=map[int]int{a:1,a:2}//mmaybe{2:1}or{2:2}:evaluationorderbetweenthetwomapassignmentsisnotspecifiedm2:=map[int]int{a:f()}//m2maybe{2:3}or{3:3}:evaluationorderbetweenthekeyandthevalueisnotspecifiedFloating-pointoperationswithinasingleexpressionareevaluatedaccordingtotheassociativityoftheoperators.Explicitparenthesesaffecttheevaluationbyoverridingthedefaultassociativity.Intheexpressionx+(y+z)theadditiony+zisperformedbeforeaddingx.StatementsStatementscontrolexecution.Statement=Declaration|LabeledStmt|SimpleStmt|GoStmt|ReturnStmt|BreakStmt|ContinueStmt|GotoStmt|FallthroughStmt|Block|IfStmt|SwitchStmt|SelectStmt|ForStmt|DeferStmt.SimpleStmt=EmptyStmt|ExpressionStmt|SendStmt|IncDecStmt|Assignment|ShortVarDecl.TerminatingstatementsAterminatingstatementisoneofthefollowing:A"return"or"goto"statement.Acalltothebuilt-infunctionpanic.Ablockinwhichthestatementlistendsinaterminatingstatement.An"if"statementinwhich:the"else"branchispresent,andbothbranchesareterminatingstatements.A"for"statementinwhich:thereareno"break"statementsreferringtothe"for"statement,andtheloopconditionisabsent.A"switch"statementinwhich:thereareno"break"statementsreferringtothe"switch"statement,thereisadefaultcase,andthestatementlistsineachcase,includingthedefault,endinaterminatingstatement,orapossiblylabeled"fallthrough"statement.A"select"statementinwhich:thereareno"break"statementsreferringtothe"select"statement,andthestatementlistsineachcase,includingthedefaultifpresent,endinaterminatingstatement.Alabeledstatementlabelingaterminatingstatement.Allotherstatementsarenotterminating.Astatementlistendsinaterminatingstatementifthelistisnotemptyanditsfinalstatementisterminating.EmptystatementsTheemptystatementdoesnothing.EmptyStmt=.LabeledstatementsAlabeledstatementmaybethetargetofagoto,breakorcontinuestatement.LabeledStmt=Label":"Statement.Label=identifier.Error:log.Panic("errorencountered")ExpressionstatementsWiththeexceptionofspecificbuilt-infunctions,functionandmethodcallsandreceiveoperationscanappearinstatementcontext.Suchstatementsmaybeparenthesized.ExpressionStmt=Expression.Thefollowingbuilt-infunctionsarenotpermittedinstatementcontext:appendcapcompleximaglenmakenewrealunsafe.Alignofunsafe.Offsetofunsafe.Sizeofh(x+y)f.Close()<-ch(<-ch)len("foo")//illegaliflenisthebuilt-infunctionSendstatementsAsendstatementsendsavalueonachannel.Thechannelexpressionmustbeofchanneltype,thechanneldirectionmustpermitsendoperations,andthetypeofthevaluetobesentmustbeassignabletothechannel'selementtype.SendStmt=Channel"<-"Expression.Channel=Expression.Boththechannelandthevalueexpressionareevaluatedbeforecommunicationbegins.Communicationblocksuntilthesendcanproceed.Asendonanunbufferedchannelcanproceedifareceiverisready.Asendonabufferedchannelcanproceedifthereisroominthebuffer.Asendonaclosedchannelproceedsbycausingarun-timepanic.Asendonanilchannelblocksforever.Channelsactasfirst-in-first-outqueues.Forexample,ifasinglegoroutinesendsonachannelvaluesthatarereceivedbyasinglegoroutine,thevaluesarereceivedintheordersent.Asinglechannelmaybeusedforsendandreceiveoperationsandcallstothebuilt-infunctionscapandlenbyanynumberofgoroutineswithoutfurthersynchronization.ch<-3IncDecstatementsThe"++"and"--"statementsincrementordecrementtheiroperandsbytheuntypedconstant1.Aswithanassignment,theoperandmustbeaddressableoramapindexexpression.IncDecStmt=Expression("++"|"--").Thefollowingassignmentstatementsaresemanticallyequivalent:IncDecstatementAssignmentx++x+=1x--x-=1AssignmentsAssignment=ExpressionListassign_opExpressionList.assign_op=[add_op|mul_op]"=".Eachleft-handsideoperandmustbeaddressable,amapindexexpression,or(for=assignmentsonly)theblankidentifier.Operandsmaybeparenthesized.x=1*p=f()a[i]=23(k)=<-ch//sameas:k=<-chAnassignmentoperationxop=ywhereopisabinaryarithmeticoperationequivalenttox=xopybutevaluatesxonlyonce.Theop=constructisasingletoken.Inassignmentoperations,boththeleft-andright-handexpressionlistsmustcontainexactlyonesingle-valuedexpression,andtheleft-handexpressionmustnotbetheblankidentifier.a[i]<<=2i&^=1<<nAtupleassignmentassignstheindividualelementsofamulti-valuedoperationtoalistofvariables.Therearetwoforms.Inthefirst,therighthandoperandisasinglemulti-valuedexpressionsuchasafunctionevaluationorchannelormapoperationoratypeassertion.Thenumberofoperandsonthelefthandsidemustmatchthenumberofvalues.Forinstance,iffisafunctionreturningtwovalues,x,y=f()assignsthefirstvaluetoxandthesecondtoy.Inthesecondform,thenumberofoperandsontheleftmustequalthenumberofexpressionsontheright,eachofwhichmustbesingle-valued,andthenthexpressionontherightisassignedtothenthoperandontheleft:one,two,three='一','二','三'Theblankidentifierprovidesawaytoignoreright-handsidevaluesinanassignment:_=x//evaluatexbutignoreitx,_=f()//evaluatef()butignoresecondresultvalueTheassignmentproceedsintwophases.First,theoperandsofindexexpressionsandpointerindirections(includingimplicitpointerindirectionsinselectors)ontheleftandtheexpressionsontherightareallevaluatedintheusualorder.Second,theassignmentsarecarriedoutinleft-to-rightorder.a,b=b,a//exchangeaandbx:=[]int{1,2,3}i:=0i,x[i]=1,2//seti=1,x[0]=2i=0x[i],i=2,1//setx[0]=2,i=1x[0],x[0]=1,2//setx[0]=1,thenx[0]=2(sox[0]==2atend)x[1],x[3]=4,5//setx[1]=4,thenpanicsettingx[3]=5.typePointstruct{x,yint}varp*Pointx[2],p.x=6,7//setx[2]=6,thenpanicsettingp.x=7i=2x=[]int{3,5,7}fori,x[i]=rangex{//seti,x[2]=0,x[0]break}//afterthisloop,i==0andx==[]int{3,5,3}Inassignments,eachvaluemustbeassignabletothetypeoftheoperandtowhichitisassigned,withthefollowingspecialcases:Ifanuntypedconstantisassignedtoavariableofinterfacetypeortheblankidentifier,theconstantisfirstconvertedtotypebool,rune,int,float64,complex128orstringrespectively,dependingonwhetherthevalueisaboolean,rune,integer,floating-point,complex,orstringconstant.Ifaleft-handsideistheblankidentifier,anytypedornon-constantvalueexceptforthepredeclaredidentifiernilmaybeassignedtoit.Ifstatements"If"statementsspecifytheconditionalexecutionoftwobranchesaccordingtothevalueofabooleanexpression.Iftheexpressionevaluatestotrue,the"if"branchisexecuted,otherwise,ifpresent,the"else"branchisexecuted.IfStmt="if"[SimpleStmt";"]ExpressionBlock["else"(IfStmt|Block)].ifx>max{x=max}Theexpressionmaybeprecededbyasimplestatement,whichexecutesbeforetheexpressionisevaluated.ifx:=f();x<y{returnx}elseifx>z{returnz}else{returny}Switchstatements"Switch"statementsprovidemulti-wayexecution.Anexpressionortypespecifieriscomparedtothe"cases"insidethe"switch"todeterminewhichbranchtoexecute.SwitchStmt=ExprSwitchStmt|TypeSwitchStmt.Therearetwoforms:expressionswitchesandtypeswitches.Inanexpressionswitch,thecasescontainexpressionsthatarecomparedagainstthevalueoftheswitchexpression.Inatypeswitch,thecasescontaintypesthatarecomparedagainstthetypeofaspeciallyannotatedswitchexpression.ExpressionswitchesInanexpressionswitch,theswitchexpressionisevaluatedandthecaseexpressions,whichneednotbeconstants,areevaluatedleft-to-rightandtop-to-bottom;thefirstonethatequalstheswitchexpressiontriggersexecutionofthestatementsoftheassociatedcase;theothercasesareskipped.Ifnocasematchesandthereisa"default"case,itsstatementsareexecuted.Therecanbeatmostonedefaultcaseanditmayappearanywhereinthe"switch"statement.Amissingswitchexpressionisequivalenttotheexpressiontrue.ExprSwitchStmt="switch"[SimpleStmt";"][Expression]"{"{ExprCaseClause}"}".ExprCaseClause=ExprSwitchCase":"StatementList.ExprSwitchCase="case"ExpressionList|"default".Inacaseordefaultclause,thelastnon-emptystatementmaybea(possiblylabeled)"fallthrough"statementtoindicatethatcontrolshouldflowfromtheendofthisclausetothefirststatementofthenextclause.Otherwisecontrolflowstotheendofthe"switch"statement.A"fallthrough"statementmayappearasthelaststatementofallbutthelastclauseofanexpressionswitch.Theexpressionmaybeprecededbyasimplestatement,whichexecutesbeforetheexpressionisevaluated.switchtag{default:s3()case0,1,2,3:s1()case4,5,6,7:s2()}switchx:=f();{//missingswitchexpressionmeans"true"casex<0:return-xdefault:returnx}switch{casex<y:f1()casex<z:f2()casex==4:f3()}TypeswitchesAtypeswitchcomparestypesratherthanvalues.Itisotherwisesimilartoanexpressionswitch.Itismarkedbyaspecialswitchexpressionthathastheformofatypeassertionusingthereservedwordtyperatherthananactualtype:switchx.(type){//cases}CasesthenmatchactualtypesTagainstthedynamictypeoftheexpressionx.Aswithtypeassertions,xmustbeofinterfacetype,andeachnon-interfacetypeTlistedinacasemustimplementthetypeofx.TypeSwitchStmt="switch"[SimpleStmt";"]TypeSwitchGuard"{"{TypeCaseClause}"}".TypeSwitchGuard=[identifier":="]PrimaryExpr".""(""type"")".TypeCaseClause=TypeSwitchCase":"StatementList.TypeSwitchCase="case"TypeList|"default".TypeList=Type{","Type}.TheTypeSwitchGuardmayincludeashortvariabledeclaration.Whenthatformisused,thevariableisdeclaredatthebeginningoftheimplicitblockineachclause.Inclauseswithacaselistingexactlyonetype,thevariablehasthattype;otherwise,thevariablehasthetypeoftheexpressionintheTypeSwitchGuard.Thetypeinacasemaybenil;thatcaseisusedwhentheexpressionintheTypeSwitchGuardisanilinterfacevalue.Givenanexpressionxoftypeinterface{},thefollowingtypeswitch:switchi:=x.(type){casenil:printString("xisnil")//typeofiistypeofx(interface{})caseint:printInt(i)//typeofiisintcasefloat64:printFloat64(i)//typeofiisfloat64casefunc(int)float64:printFunction(i)//typeofiisfunc(int)float64casebool,string:printString("typeisboolorstring")//typeofiistypeofx(interface{})default:printString("don'tknowthetype")//typeofiistypeofx(interface{})}couldberewritten:v:=x//xisevaluatedexactlyonceifv==nil{i:=v//typeofiistypeofx(interface{})printString("xisnil")}elseifi,isInt:=v.(int);isInt{printInt(i)//typeofiisint}elseifi,isFloat64:=v.(float64);isFloat64{printFloat64(i)//typeofiisfloat64}elseifi,isFunc:=v.(func(int)float64);isFunc{printFunction(i)//typeofiisfunc(int)float64}else{_,isBool:=v.(bool)_,isString:=v.(string)ifisBool||isString{i:=v//typeofiistypeofx(interface{})printString("typeisboolorstring")}else{i:=v//typeofiistypeofx(interface{})printString("don'tknowthetype")}}Thetypeswitchguardmaybeprecededbyasimplestatement,whichexecutesbeforetheguardisevaluated.The"fallthrough"statementisnotpermittedinatypeswitch.ForstatementsA"for"statementspecifiesrepeatedexecutionofablock.Theiterationiscontrolledbyacondition,a"for"clause,ora"range"clause.ForStmt="for"[Condition|ForClause|RangeClause]Block.Condition=Expression.Initssimplestform,a"for"statementspecifiestherepeatedexecutionofablockaslongasabooleanconditionevaluatestotrue.Theconditionisevaluatedbeforeeachiteration.Iftheconditionisabsent,itisequivalenttotrue.fora<b{a*=2}A"for"statementwithaForClauseisalsocontrolledbyitscondition,butadditionallyitmayspecifyaninitandapoststatement,suchasanassignment,anincrementordecrementstatement.Theinitstatementmaybeashortvariabledeclaration,butthepoststatementmustnot.ForClause=[InitStmt]";"[Condition]";"[PostStmt].InitStmt=SimpleStmt.PostStmt=SimpleStmt.fori:=0;i<10;i++{f(i)}Ifnon-empty,theinitstatementisexecutedoncebeforeevaluatingtheconditionforthefirstiteration;thepoststatementisexecutedaftereachexecutionoftheblock(andonlyiftheblockwasexecuted).AnyelementoftheForClausemaybeemptybutthesemicolonsarerequiredunlessthereisonlyacondition.Iftheconditionisabsent,itisequivalenttotrue.forcond{S()}isthesameasfor;cond;{S()}for{S()}isthesameasfortrue{S()}A"for"statementwitha"range"clauseiteratesthroughallentriesofanarray,slice,stringormap,orvaluesreceivedonachannel.Foreachentryitassignsiterationvaluestocorrespondingiterationvariablesandthenexecutestheblock.RangeClause=(ExpressionList"="|IdentifierList":=")"range"Expression.Theexpressionontherightinthe"range"clauseiscalledtherangeexpression,whichmaybeanarray,pointertoanarray,slice,string,map,orchannelpermittingreceiveoperations.Aswithanassignment,theoperandsontheleftmustbeaddressableormapindexexpressions;theydenotetheiterationvariables.Iftherangeexpressionisachannel,onlyoneiterationvariableispermitted,otherwisetheremaybeoneortwo.Inthelattercase,iftheseconditerationvariableistheblankidentifier,therangeclauseisequivalenttothesameclausewithonlythefirstvariablepresent.Therangeexpressionisevaluatedoncebeforebeginningtheloop,withoneexception.Iftherangeexpressionisanarrayorapointertoanarrayandonlythefirstiterationvalueispresent,onlytherangeexpression'slengthisevaluated;ifthatlengthisconstantbydefinition,therangeexpressionitselfwillnotbeevaluated.Functioncallsontheleftareevaluatedonceperiteration.Foreachiteration,iterationvaluesareproducedasfollows:Rangeexpression1stvalue2ndvalue(if2ndvariableispresent)arrayorslicea[n]E,*[n]E,or[]Eindexiinta[i]Estringsstringtypeindexiintseebelowrunemapmmap[K]VkeykKm[k]VchannelcchanE,<-chanEelementeEForanarray,pointertoarray,orslicevaluea,theindexiterationvaluesareproducedinincreasingorder,startingatelementindex0.Ifonlythefirstiterationvariableispresent,therangeloopproducesiterationvaluesfrom0uptolen(a)-1anddoesnotindexintothearrayorsliceitself.Foranilslice,thenumberofiterationsis0.Forastringvalue,the"range"clauseiteratesovertheUnicodecodepointsinthestringstartingatbyteindex0.Onsuccessiveiterations,theindexvaluewillbetheindexofthefirstbyteofsuccessiveUTF-8-encodedcodepointsinthestring,andthesecondvalue,oftyperune,willbethevalueofthecorrespondingcodepoint.IftheiterationencountersaninvalidUTF-8sequence,thesecondvaluewillbe0xFFFD,theUnicodereplacementcharacter,andthenextiterationwilladvanceasinglebyteinthestring.Theiterationorderovermapsisnotspecifiedandisnotguaranteedtobethesamefromoneiterationtothenext.Ifmapentriesthathavenotyetbeenreachedareremovedduringiteration,thecorrespondingiterationvalueswillnotbeproduced.Ifmapentriesarecreatedduringiteration,thatentrymaybeproducedduringtheiterationormaybeskipped.Thechoicemayvaryforeachentrycreatedandfromoneiterationtothenext.Ifthemapisnil,thenumberofiterationsis0.Forchannels,theiterationvaluesproducedarethesuccessivevaluessentonthechanneluntilthechannelisclosed.Ifthechannelisnil,therangeexpressionblocksforever.Theiterationvaluesareassignedtotherespectiveiterationvariablesasinanassignmentstatement.Theiterationvariablesmaybedeclaredbythe"range"clauseusingaformofshortvariabledeclaration(:=).Inthiscasetheirtypesaresettothetypesoftherespectiveiterationvaluesandtheirscopeendsattheendofthe"for"statement;theyarere-usedineachiteration.Iftheiterationvariablesaredeclaredoutsidethe"for"statement,afterexecutiontheirvalueswillbethoseofthelastiteration.vartestdata*struct{a*[7]int}fori,_:=rangetestdata.a{//testdata.aisneverevaluated;len(testdata.a)isconstant//irangesfrom0to6f(i)}vara[10]stringfori,s:=rangea{//typeofiisint//typeofsisstring//s==a[i]g(i,s)}varkeystringvarvalinterface{}//valuetypeofmisassignabletovalm:=map[string]int{"mon":0,"tue":1,"wed":2,"thu":3,"fri":4,"sat":5,"sun":6}forkey,val=rangem{h(key,val)}//key==lastmapkeyencounterediniteration//val==map[key]varchchanWork=producer()forw:=rangech{doWork(w)}GostatementsA"go"statementstartstheexecutionofafunctioncallasanindependentconcurrentthreadofcontrol,orgoroutine,withinthesameaddressspace.GoStmt="go"Expression.Theexpressionmustbeafunctionormethodcall;itcannotbeparenthesized.Callsofbuilt-infunctionsarerestrictedasforexpressionstatements.Thefunctionvalueandparametersareevaluatedasusualinthecallinggoroutine,butunlikewitharegularcall,programexecutiondoesnotwaitfortheinvokedfunctiontocomplete.Instead,thefunctionbeginsexecutingindependentlyinanewgoroutine.Whenthefunctionterminates,itsgoroutinealsoterminates.Ifthefunctionhasanyreturnvalues,theyarediscardedwhenthefunctioncompletes.goServer()gofunc(chchan<-bool){for{sleep(10);ch<-true;}}(c)SelectstatementsA"select"statementchooseswhichofasetofpossiblecommunicationswillproceed.Itlookssimilartoa"switch"statementbutwiththecasesallreferringtocommunicationoperations.SelectStmt="select""{"{CommClause}"}".CommClause=CommCase":"StatementList.CommCase="case"(SendStmt|RecvStmt)|"default".RecvStmt=[ExpressionList"="|IdentifierList":="]RecvExpr.RecvExpr=Expression.RecvExprmustbeareceiveoperation.Forallthecasesinthe"select"statement,thechannelexpressionsareevaluatedintop-to-bottomorder,alongwithanyexpressionsthatappearontherighthandsideofsendstatements.Achannelmaybenil,whichisequivalenttothatcasenotbeingpresentintheselectstatementexcept,ifasend,itsexpressionisstillevaluated.Ifanyoftheresultingoperationscanproceed,oneofthoseischosenandthecorrespondingcommunicationandstatementsareevaluated.Otherwise,ifthereisadefaultcase,thatexecutes;ifthereisnodefaultcase,thestatementblocksuntiloneofthecommunicationscancomplete.Therecanbeatmostonedefaultcaseanditmayappearanywhereinthe"select"statement.Iftherearenocaseswithnon-nilchannels,thestatementblocksforever.Evenifthestatementblocks,thechannelandsendexpressionsareevaluatedonlyonce,uponenteringtheselectstatement.Sinceallthechannelsandsendexpressionsareevaluated,anysideeffectsinthatevaluationwilloccurforallthecommunicationsinthe"select"statement.Ifmultiplecasescanproceed,auniformpseudo-randomchoiceismadetodecidewhichsinglecommunicationwillexecute.Thereceivecasemaydeclareoneortwonewvariablesusingashortvariabledeclaration.varc,c1,c2,c3chanintvari1,i2intselect{casei1=<-c1:print("received",i1,"fromc1\n")casec2<-i2:print("sent",i2,"toc2\n")casei3,ok:=(<-c3)://sameas:i3,ok:=<-c3ifok{print("received",i3,"fromc3\n")}else{print("c3isclosed\n")}default:print("nocommunication\n")}for{//sendrandomsequenceofbitstocselect{casec<-0://note:nostatement,nofallthrough,nofoldingofcasescasec<-1:}}select{}//blockforeverReturnstatementsA"return"statementinafunctionFterminatestheexecutionofF,andoptionallyprovidesoneormoreresultvalues.AnyfunctionsdeferredbyFareexecutedbeforeFreturnstoitscaller.ReturnStmt="return"[ExpressionList].Inafunctionwithoutaresulttype,a"return"statementmustnotspecifyanyresultvalues.funcnoResult(){return}Therearethreewaystoreturnvaluesfromafunctionwitharesulttype:Thereturnvalueorvaluesmaybeexplicitlylistedinthe"return"statement.Eachexpressionmustbesingle-valuedandassignabletothecorrespondingelementofthefunction'sresulttype.funcsimpleF()int{return2}funccomplexF1()(refloat64,imfloat64){return-7.0,-4.0}Theexpressionlistinthe"return"statementmaybeasinglecalltoamulti-valuedfunction.Theeffectisasifeachvaluereturnedfromthatfunctionwereassignedtoatemporaryvariablewiththetypeoftherespectivevalue,followedbya"return"statementlistingthesevariables,atwhichpointtherulesofthepreviouscaseapply.funccomplexF2()(refloat64,imfloat64){returncomplexF1()}Theexpressionlistmaybeemptyifthefunction'sresulttypespecifiesnamesforitsresultparameters.Theresultparametersactasordinarylocalvariablesandthefunctionmayassignvaluestothemasnecessary.The"return"statementreturnsthevaluesofthesevariables.funccomplexF3()(refloat64,imfloat64){re=7.0im=4.0return}func(devnull)Write(p[]byte)(nint,_error){n=len(p)return}Regardlessofhowtheyaredeclared,alltheresultvaluesareinitializedtothezerovaluesfortheirtypeuponentrytothefunction.A"return"statementthatspecifiesresultssetstheresultparametersbeforeanydeferredfunctionsareexecuted.BreakstatementsA"break"statementterminatesexecutionoftheinnermost"for","switch",or"select"statement.BreakStmt="break"[Label].Ifthereisalabel,itmustbethatofanenclosing"for","switch",or"select"statement,andthatistheonewhoseexecutionterminates.OuterLoop:fori=0;i<n;i++{forj=0;j<m;j++{switcha[i][j]{casenil:state=ErrorbreakOuterLoopcaseitem:state=FoundbreakOuterLoop}}}ContinuestatementsA"continue"statementbeginsthenextiterationoftheinnermost"for"loopatitspoststatement.ContinueStmt="continue"[Label].Ifthereisalabel,itmustbethatofanenclosing"for"statement,andthatistheonewhoseexecutionadvances.RowLoop:fory,row:=rangerows{forx,data:=rangerow{ifdata==endOfRow{continueRowLoop}row[x]=data+bias(x,y)}}GotostatementsA"goto"statementtransferscontroltothestatementwiththecorrespondinglabel.GotoStmt="goto"Label.gotoErrorExecutingthe"goto"statementmustnotcauseanyvariablestocomeintoscopethatwerenotalreadyinscopeatthepointofthegoto.Forinstance,thisexample:gotoL//BADv:=3L:iserroneousbecausethejumptolabelLskipsthecreationofv.A"goto"statementoutsideablockcannotjumptoalabelinsidethatblock.Forinstance,thisexample:ifn%2==1{gotoL1}forn>0{f()n--L1:f()n--}iserroneousbecausethelabelL1isinsidethe"for"statement'sblockbutthegotoisnot.FallthroughstatementsA"fallthrough"statementtransferscontroltothefirststatementofthenextcaseclauseinaexpression"switch"statement.Itmaybeusedonlyasthefinalnon-emptystatementinsuchaclause.FallthroughStmt="fallthrough".DeferstatementsA"defer"statementinvokesafunctionwhoseexecutionisdeferredtothemomentthesurroundingfunctionreturns,eitherbecausethesurroundingfunctionexecutedareturnstatement,reachedtheendofitsfunctionbody,orbecausethecorrespondinggoroutineispanicking.DeferStmt="defer"Expression.Theexpressionmustbeafunctionormethodcall;itcannotbeparenthesized.Callsofbuilt-infunctionsarerestrictedasforexpressionstatements.Eachtimethe"defer"statementexecutes,thefunctionvalueandparameterstothecallareevaluatedasusualandsavedanewbuttheactualfunctionbodyisnotexecuted.Instead,deferredfunctionsareexecutedimmediatelybeforethesurroundingfunctionreturns,inthereverseordertheyweredeferred.Forinstance,ifthedeferredfunctionisafunctionliteralandthesurroundingfunctionhasnamedresultparametersthatareinscopewithintheliteral,thedeferredfunctionmayaccessandmodifytheresultparametersbeforetheyarereturned.Ifthedeferredfunctionhasanyreturnvalues,theyarediscardedwhenthefunctioncompletes.(Seealsothesectiononhandlingpanics.)lock(l)deferunlock(l)//unlockinghappensbeforesurroundingfunctionreturns//prints3210beforesurroundingfunctionreturnsfori:=0;i<=3;i++{deferfmt.Print(i)}//freturns1funcf()(resultint){deferfunc(){result++}()return0}Built-infunctionsBuilt-infunctionsarepredeclared.Theyarecalledlikeanyotherfunctionbutsomeofthemacceptatypeinsteadofanexpressionasthefirstargument.Thebuilt-infunctionsdonothavestandardGotypes,sotheycanonlyappearincallexpressions;theycannotbeusedasfunctionvalues.BuiltinCall=identifier"("[BuiltinArgs[","]]")".BuiltinArgs=Type[","ArgumentList]|ArgumentList.CloseForachannelc,thebuilt-infunctionclose(c)recordsthatnomorevalueswillbesentonthechannel.Itisanerrorifcisareceive-onlychannel.Sendingtoorclosingaclosedchannelcausesarun-timepanic.Closingthenilchannelalsocausesarun-timepanic.Aftercallingclose,andafteranypreviouslysentvalueshavebeenreceived,receiveoperationswillreturnthezerovalueforthechannel'stypewithoutblocking.Themulti-valuedreceiveoperationreturnsareceivedvaluealongwithanindicationofwhetherthechannelisclosed.LengthandcapacityThebuilt-infunctionslenandcaptakeargumentsofvarioustypesandreturnaresultoftypeint.Theimplementationguaranteesthattheresultalwaysfitsintoanint.CallArgumenttypeResultlen(s)stringtypestringlengthinbytes[n]T,*[n]Tarraylength(==n)[]Tslicelengthmap[K]Tmaplength(numberofdefinedkeys)chanTnumberofelementsqueuedinchannelbuffercap(s)[n]T,*[n]Tarraylength(==n)[]TslicecapacitychanTchannelbuffercapacityThecapacityofasliceisthenumberofelementsforwhichthereisspaceallocatedintheunderlyingarray.Atanytimethefollowingrelationshipholds:0<=len(s)<=cap(s)Thelengthofanilslice,maporchannelis0.Thecapacityofanilsliceandchannelis0.Theexpressionlen(s)isconstantifsisastringconstant.Theexpressionslen(s)andcap(s)areconstantsifthetypeofsisanarrayorpointertoanarrayandtheexpressionsdoesnotcontainchannelreceivesorfunctioncalls;inthiscasesisnotevaluated.Otherwise,invocationsoflenandcaparenotconstantandsisevaluated.AllocationThebuilt-infunctionnewtakesatypeTandreturnsavalueoftype*T.Thememoryisinitializedasdescribedinthesectiononinitialvalues.new(T)ForinstancetypeSstruct{aint;bfloat64}new(S)dynamicallyallocatesmemoryforavariableoftypeS,initializesit(a=0,b=0.0),andreturnsavalueoftype*Scontainingtheaddressofthememory.Makingslices,mapsandchannelsThebuilt-infunctionmaketakesatypeT,whichmustbeaslice,maporchanneltype,optionallyfollowedbyatype-specificlistofexpressions.ItreturnsavalueoftypeT(not*T).Thememoryisinitializedasdescribedinthesectiononinitialvalues.CallTypeTResultmake(T,n)slicesliceoftypeTwithlengthnandcapacitynmake(T,n,m)slicesliceoftypeTwithlengthnandcapacitymmake(T)mapmapoftypeTmake(T,n)mapmapoftypeTwithinitialspacefornelementsmake(T)channelsynchronouschanneloftypeTmake(T,n)channelasynchronouschanneloftypeT,buffersizenThesizeargumentsnandmmustbeofintegertypeoruntyped.Aconstantsizeargumentmustbenon-negativeandrepresentablebyavalueoftypeint.Ifbothnandmareprovidedandareconstant,thennmustbenolargerthanm.Ifnisnegativeorlargerthanmatruntime,arun-timepanicoccurs.s:=make([]int,10,100)//slicewithlen(s)==10,cap(s)==100s:=make([]int,1e3)//slicewithlen(s)==cap(s)==1000s:=make([]int,1<<63)//illegal:len(s)isnotrepresentablebyavalueoftypeints:=make([]int,10,0)//illegal:len(s)>cap(s)c:=make(chanint,10)//channelwithabuffersizeof10m:=make(map[string]int,100)//mapwithinitialspacefor100elementsAppendingtoandcopyingslicesThebuilt-infunctionsappendandcopyassistincommonsliceoperations.Forbothfunctions,theresultisindependentofwhetherthememoryreferencedbytheargumentsoverlaps.ThevariadicfunctionappendappendszeroormorevaluesxtosoftypeS,whichmustbeaslicetype,andreturnstheresultingslice,alsooftypeS.Thevaluesxarepassedtoaparameteroftype...TwhereTistheelementtypeofSandtherespectiveparameterpassingrulesapply.Asaspecialcase,appendalsoacceptsafirstargumentassignabletotype[]bytewithasecondargumentofstringtypefollowedby....Thisformappendsthebytesofthestring.append(sS,x...T)S//TistheelementtypeofSIfthecapacityofsisnotlargeenoughtofittheadditionalvalues,appendallocatesanew,sufficientlylargeunderlyingarraythatfitsboththeexistingsliceelementsandtheadditionalvalues.Otherwise,appendre-usestheunderlyingarray.s0:=[]int{0,0}s1:=append(s0,2)//appendasingleelements1==[]int{0,0,2}s2:=append(s1,3,5,7)//appendmultipleelementss2==[]int{0,0,2,3,5,7}s3:=append(s2,s0...)//appendaslices3==[]int{0,0,2,3,5,7,0,0}s4:=append(s3[3:6],s3[2:]...)//appendoverlappingslices4==[]int{3,5,7,2,3,5,7,0,0}vart[]interface{}t=append(t,42,3.1415,"foo")t==[]interface{}{42,3.1415,"foo"}varb[]byteb=append(b,"bar"...)//appendstringcontentsb==[]byte{'b','a','r'}Thefunctioncopycopiessliceelementsfromasourcesrctoadestinationdstandreturnsthenumberofelementscopied.BothargumentsmusthaveidenticalelementtypeTandmustbeassignabletoasliceoftype[]T.Thenumberofelementscopiedistheminimumoflen(src)andlen(dst).Asaspecialcase,copyalsoacceptsadestinationargumentassignabletotype[]bytewithasourceargumentofastringtype.Thisformcopiesthebytesfromthestringintothebyteslice.copy(dst,src[]T)intcopy(dst[]byte,srcstring)intExamples:vara=[...]int{0,1,2,3,4,5,6,7}vars=make([]int,6)varb=make([]byte,5)n1:=copy(s,a[0:])//n1==6,s==[]int{0,1,2,3,4,5}n2:=copy(s,s[2:])//n2==4,s==[]int{2,3,4,5,4,5}n3:=copy(b,"Hello,World!")//n3==5,b==[]byte("Hello")DeletionofmapelementsThebuilt-infunctiondeleteremovestheelementwithkeykfromamapm.Thetypeofkmustbeassignabletothekeytypeofm.delete(m,k)//removeelementm[k]frommapmIfthemapmisnilortheelementm[k]doesnotexist,deleteisano-op.ManipulatingcomplexnumbersThreefunctionsassembleanddisassemblecomplexnumbers.Thebuilt-infunctioncomplexconstructsacomplexvaluefromafloating-pointrealandimaginarypart,whilerealandimagextracttherealandimaginarypartsofacomplexvalue.complex(realPart,imaginaryPartfloatT)complexTreal(complexT)floatTimag(complexT)floatTThetypeoftheargumentsandreturnvaluecorrespond.Forcomplex,thetwoargumentsmustbeofthesamefloating-pointtypeandthereturntypeisthecomplextypewiththecorrespondingfloating-pointconstituents:complex64forfloat32,complex128forfloat64.Therealandimagfunctionstogetherformtheinverse,soforacomplexvaluez,z==complex(real(z),imag(z)).Iftheoperandsofthesefunctionsareallconstants,thereturnvalueisaconstant.vara=complex(2,-2)//complex128varb=complex(1.0,-1.4)//complex128x:=float32(math.Cos(math.Pi/2))//float32varc64=complex(5,-x)//complex64varim=imag(b)//float64varrl=real(c64)//float32HandlingpanicsTwobuilt-infunctions,panicandrecover,assistinreportingandhandlingrun-timepanicsandprogram-definederrorconditions.funcpanic(interface{})funcrecover()interface{}WhileexecutingafunctionF,anexplicitcalltopanicorarun-timepanicterminatestheexecutionofF.AnyfunctionsdeferredbyFarethenexecutedasusual.Next,anydeferredfunctionsrunbyF'scallerarerun,andsoonuptoanydeferredbythetop-levelfunctionintheexecutinggoroutine.Atthatpoint,theprogramisterminatedandtheerrorconditionisreported,includingthevalueoftheargumenttopanic.Thisterminationsequenceiscalledpanicking.panic(42)panic("unreachable")panic(Error("cannotparse"))Therecoverfunctionallowsaprogramtomanagebehaviorofapanickinggoroutine.SupposeafunctionGdefersafunctionDthatcallsrecoverandapanicoccursinafunctiononthesamegoroutineinwhichGisexecuting.WhentherunningofdeferredfunctionsreachesD,thereturnvalueofD'scalltorecoverwillbethevaluepassedtothecallofpanic.IfDreturnsnormally,withoutstartinganewpanic,thepanickingsequencestops.Inthatcase,thestateoffunctionscalledbetweenGandthecalltopanicisdiscarded,andnormalexecutionresumes.AnyfunctionsdeferredbyGbeforeDarethenrunandG'sexecutionterminatesbyreturningtoitscaller.Thereturnvalueofrecoverisnilifanyofthefollowingconditionsholds:panic'sargumentwasnil;thegoroutineisnotpanicking;recoverwasnotcalleddirectlybyadeferredfunction.Theprotectfunctionintheexamplebelowinvokesthefunctionargumentgandprotectscallersfromrun-timepanicsraisedbyg.funcprotect(gfunc()){deferfunc(){log.Println("done")//Printlnexecutesnormallyevenifthereisapanicifx:=recover();x!=nil{log.Printf("runtimepanic:%v",x)}}()log.Println("start")g()}BootstrappingCurrentimplementationsprovideseveralbuilt-infunctionsusefulduringbootstrapping.Thesefunctionsaredocumentedforcompletenessbutarenotguaranteedtostayinthelanguage.Theydonotreturnaresult.FunctionBehaviorprintprintsallarguments;formattingofargumentsisimplementation-specificprintlnlikeprintbutprintsspacesbetweenargumentsandanewlineattheendPackagesGoprogramsareconstructedbylinkingtogetherpackages.Apackageinturnisconstructedfromoneormoresourcefilesthattogetherdeclareconstants,types,variablesandfunctionsbelongingtothepackageandwhichareaccessibleinallfilesofthesamepackage.Thoseelementsmaybeexportedandusedinanotherpackage.SourcefileorganizationEachsourcefileconsistsofapackageclausedefiningthepackagetowhichitbelongs,followedbyapossiblyemptysetofimportdeclarationsthatdeclarepackageswhosecontentsitwishestouse,followedbyapossiblyemptysetofdeclarationsoffunctions,types,variables,andconstants.SourceFile=PackageClause";"{ImportDecl";"}{TopLevelDecl";"}.PackageclauseApackageclausebeginseachsourcefileanddefinesthepackagetowhichthefilebelongs.PackageClause="package"PackageName.PackageName=identifier.ThePackageNamemustnotbetheblankidentifier.packagemathAsetoffilessharingthesamePackageNameformtheimplementationofapackage.Animplementationmayrequirethatallsourcefilesforapackageinhabitthesamedirectory.ImportdeclarationsAnimportdeclarationstatesthatthesourcefilecontainingthedeclarationdependsonfunctionalityoftheimportedpackage(§Programinitializationandexecution)andenablesaccesstoexportedidentifiersofthatpackage.Theimportnamesanidentifier(PackageName)tobeusedforaccessandanImportPaththatspecifiesthepackagetobeimported.ImportDecl="import"(ImportSpec|"("{ImportSpec";"}")").ImportSpec=["."|PackageName]ImportPath.ImportPath=string_lit.ThePackageNameisusedinqualifiedidentifierstoaccessexportedidentifiersofthepackagewithintheimportingsourcefile.Itisdeclaredinthefileblock.IfthePackageNameisomitted,itdefaultstotheidentifierspecifiedinthepackageclauseoftheimportedpackage.Ifanexplicitperiod(.)appearsinsteadofaname,allthepackage'sexportedidentifiersdeclaredinthatpackage'spackageblockwillbedeclaredintheimportingsourcefile'sfileblockandcanbeaccessedwithoutaqualifier.TheinterpretationoftheImportPathisimplementation-dependentbutitistypicallyasubstringofthefullfilenameofthecompiledpackageandmayberelativetoarepositoryofinstalledpackages.Implementationrestriction:AcompilermayrestrictImportPathstonon-emptystringsusingonlycharactersbelongingtoUnicode'sL,M,N,P,andSgeneralcategories(theGraphiccharacterswithoutspaces)andmayalsoexcludethecharacters!"#$%&'()*,:;<=>?[\]^`{|}andtheUnicodereplacementcharacterU+FFFD.Assumewehavecompiledapackagecontainingthepackageclausepackagemath,whichexportsfunctionSin,andinstalledthecompiledpackageinthefileidentifiedby"lib/math".ThistableillustrateshowSinmaybeaccessedinfilesthatimportthepackageafterthevarioustypesofimportdeclaration.ImportdeclarationLocalnameofSinimport"lib/math"math.Sinimportm"lib/math"m.Sinimport."lib/math"SinAnimportdeclarationdeclaresadependencyrelationbetweentheimportingandimportedpackage.Itisillegalforapackagetoimportitself,directlyorindirectly,ortodirectlyimportapackagewithoutreferringtoanyofitsexportedidentifiers.Toimportapackagesolelyforitsside-effects(initialization),usetheblankidentifierasexplicitpackagename:import_"lib/math"AnexamplepackageHereisacompleteGopackagethatimplementsaconcurrentprimesieve.packagemainimport"fmt"//Sendthesequence2,3,4,…tochannel'ch'.funcgenerate(chchan<-int){fori:=2;;i++{ch<-i//Send'i'tochannel'ch'.}}//Copythevaluesfromchannel'src'tochannel'dst',//removingthosedivisibleby'prime'.funcfilter(src<-chanint,dstchan<-int,primeint){fori:=rangesrc{//Loopovervaluesreceivedfrom'src'.ifi%prime!=0{dst<-i//Send'i'tochannel'dst'.}}}//Theprimesieve:Daisy-chainfilterprocessestogether.funcsieve(){ch:=make(chanint)//Createanewchannel.gogenerate(ch)//Startgenerate()asasubprocess.for{prime:=<-chfmt.Print(prime,"\n")ch1:=make(chanint)gofilter(ch,ch1,prime)ch=ch1}}funcmain(){sieve()}PrograminitializationandexecutionThezerovalueWhenmemoryisallocatedtostoreavalue,eitherthroughadeclarationoracallofmakeornew,andnoexplicitinitializationisprovided,thememoryisgivenadefaultinitialization.Eachelementofsuchavalueissettothezerovalueforitstype:falseforbooleans,0forintegers,0.0forfloats,""forstrings,andnilforpointers,functions,interfaces,slices,channels,andmaps.Thisinitializationisdonerecursively,soforinstanceeachelementofanarrayofstructswillhaveitsfieldszeroedifnovalueisspecified.Thesetwosimpledeclarationsareequivalent:variintvariint=0AftertypeTstruct{iint;ffloat64;next*T}t:=new(T)thefollowingholds:t.i==0t.f==0.0t.next==nilThesamewouldalsobetrueaftervartTProgramexecutionApackagewithnoimportsisinitializedbyassigninginitialvaluestoallitspackage-levelvariablesandthencallinganypackage-levelfunctionwiththenameandsignatureoffuncinit()definedinitssource.Apackage-scopeorfile-scopeidentifierwithnameinitmayonlybedeclaredtobeafunctionwiththissignature.Multiplesuchfunctionsmaybedefined,evenwithinasinglesourcefile;theyexecuteinunspecifiedorder.Withinapackage,package-levelvariablesareinitialized,andconstantvaluesaredetermined,accordingtoorderofreference:iftheinitializerofAdependsonB,AwillbesetafterB.Dependencyanalysisdoesnotdependontheactualvaluesoftheitemsbeinginitialized,onlyontheirappearanceinthesource.AdependsonBifthevalueofAcontainsamentionofB,containsavaluewhoseinitializermentionsB,ormentionsafunctionthatmentionsB,recursively.Itisanerrorifsuchdependenciesformacycle.Iftwoitemsarenotinterdependent,theywillbeinitializedintheordertheyappearinthesource,possiblyinmultiplefiles,aspresentedtothecompiler.Sincethedependencyanalysisisdoneperpackage,itcanproduceunspecifiedresultsifA'sinitializercallsafunctiondefinedinanotherpackagethatreferstoB.Aninitfunctioncannotbereferredtofromanywhereinaprogram.Inparticular,initcannotbecalledexplicitly,norcanapointertoinitbeassignedtoafunctionvariable.Ifapackagehasimports,theimportedpackagesareinitializedbeforeinitializingthepackageitself.IfmultiplepackagesimportapackageP,Pwillbeinitializedonlyonce.Theimportingofpackages,byconstruction,guaranteesthattherecanbenocyclicdependenciesininitialization.Acompleteprogramiscreatedbylinkingasingle,unimportedpackagecalledthemainpackagewithallthepackagesitimports,transitively.Themainpackagemusthavepackagenamemainanddeclareafunctionmainthattakesnoargumentsandreturnsnovalue.funcmain(){…}Programexecutionbeginsbyinitializingthemainpackageandtheninvokingthefunctionmain.Whenthefunctionmainreturns,theprogramexits.Itdoesnotwaitforother(non-main)goroutinestocomplete.Packageinitialization—variableinitializationandtheinvocationofinitfunctions—happensinasinglegoroutine,sequentially,onepackageatatime.Aninitfunctionmaylaunchothergoroutines,whichcanrunconcurrentlywiththeinitializationcode.However,initializationalwayssequencestheinitfunctions:itwillnotstartthenextinituntilthepreviousonehasreturned.ErrorsThepredeclaredtypeerrorisdefinedastypeerrorinterface{Error()string}Itistheconventionalinterfaceforrepresentinganerrorcondition,withthenilvaluerepresentingnoerror.Forinstance,afunctiontoreaddatafromafilemightbedefined:funcRead(f*File,b[]byte)(nint,errerror)Run-timepanicsExecutionerrorssuchasattemptingtoindexanarrayoutofboundstriggerarun-timepanicequivalenttoacallofthebuilt-infunctionpanicwithavalueoftheimplementation-definedinterfacetyperuntime.Error.Thattypesatisfiesthepredeclaredinterfacetypeerror.Theexacterrorvaluesthatrepresentdistinctrun-timeerrorconditionsareunspecified.packageruntimetypeErrorinterface{error//andperhapsothermethods}SystemconsiderationsPackageunsafeThebuilt-inpackageunsafe,knowntothecompiler,providesfacilitiesforlow-levelprogrammingincludingoperationsthatviolatethetypesystem.Apackageusingunsafemustbevettedmanuallyfortypesafety.Thepackageprovidesthefollowinginterface:packageunsafetypeArbitraryTypeint//shorthandforanarbitraryGotype;itisnotarealtypetypePointer*ArbitraryTypefuncAlignof(variableArbitraryType)uintptrfuncOffsetof(selectorArbitraryType)uintptrfuncSizeof(variableArbitraryType)uintptrAnypointerorvalueofunderlyingtypeuintptrcanbeconvertedtoaPointertypeandviceversa.APointerisapointertypebutaPointervaluemaynotbedereferenced.varffloat64bits=*(*uint64)(unsafe.Pointer(&f))typeptrunsafe.Pointerbits=*(*uint64)(ptr(&f))varpptr=nilThefunctionsAlignofandSizeoftakeanexpressionxofanytypeandreturnthealignmentorsize,respectively,ofahypotheticalvariablevasifvwasdeclaredviavarv=x.ThefunctionOffsetoftakesa(possiblyparenthesized)selectors.f,denotingafieldfofthestructdenotedbysor*s,andreturnsthefieldoffsetinbytesrelativetothestruct'saddress.Iffisanembeddedfield,itmustbereachablewithoutpointerindirectionsthroughfieldsofthestruct.Forastructswithfieldf:uintptr(unsafe.Pointer(&s))+unsafe.Offsetof(s.f)==uintptr(unsafe.Pointer(&s.f))Computerarchitecturesmayrequirememoryaddressestobealigned;thatis,foraddressesofavariabletobeamultipleofafactor,thevariable'stype'salignment.ThefunctionAlignoftakesanexpressiondenotingavariableofanytypeandreturnsthealignmentofthe(typeofthe)variableinbytes.Foravariablex:uintptr(unsafe.Pointer(&x))%unsafe.Alignof(x)==0CallstoAlignof,Offsetof,andSizeofarecompile-timeconstantexpressionsoftypeuintptr.SizeandalignmentguaranteesForthenumerictypes,thefollowingsizesareguaranteed:typesizeinbytesbyte,uint8,int81uint16,int162uint32,int32,float324uint64,int64,float64,complex648complex12816Thefollowingminimalalignmentpropertiesareguaranteed:Foravariablexofanytype:unsafe.Alignof(x)isatleast1.Foravariablexofstructtype:unsafe.Alignof(x)isthelargestofallthevaluesunsafe.Alignof(x.f)foreachfieldfofx,butatleast1.Foravariablexofarraytype:unsafe.Alignof(x)isthesameasunsafe.Alignof(x[0]),butatleast1.Astructorarraytypehassizezeroifitcontainsnofields(orelements,respectively)thathaveasizegreaterthanzero.Twodistinctzero-sizevariablesmayhavethesameaddressinmemory.Buildversiongo1.2.Exceptasnoted,thecontentofthispageislicensedundertheCreativeCommonsAttribution3.0License,andcodeislicensedunderaBSDlicense.TermsofService|PrivacyPolicy
